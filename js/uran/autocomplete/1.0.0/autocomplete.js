define("uran/autocomplete/1.0.0/js/autocomplete",["$","lib/widget/1.0.3/widget","lib/base/1.0.1/base","lib/class/1.0.0/class","lib/events/1.0.0/events","uran/base/1.0.0/js/detect"],function(t){var e=t("$"),a=t("lib/widget/1.0.3/widget"),i=t("uran/base/1.0.0/js/detect"),o=a.extend({attrs:{trigger:{value:null,getter:function(t){return e(t)}},parentNode:{value:null,getter:function(t){return e(t).first()}},template:'<ul data-role="autocomplete" class="ui-autocomplete"></ul>',itemTemplate:'<li data-role="item" class="ui-autocomplete-item">{{value}}</li>',delay:300,dataSource:[]},events:{"touchstart [data-role=item]":"_touchstart","touchmove [data-role=item]":"_touchmove","touchend [data-role=item]":"_touchend"},delegateEvents:function(){i.support.touch||(this.events={"click [data-role=item]":"_click"}),o.superclass.delegateEvents.apply(this,arguments)},setup:function(){this.get("trigger").attr("autocomplete","off").on("blur.autocomplete",e.proxy(this._blurEvent,this)).on("input.autocomplete",e.proxy(this._inputEvent,this)),this.get("parentNode").append(this.element.hide())},_blurEvent:function(){this._hideTimer=setTimeout(e.proxy(this,"hide"),50)},_inputEvent:function(){var t=this.get("trigger").val();if(this.valueCache!==t){this.valueCache=t;var a,i=this.get("dataSource");a="function"==typeof i?i(t,e.proxy(this,"_dataRender")):i,a&&this._dataRender(a)}},_dataRender:function(t){if(!("object"==typeof t&&t.length>0))return this.hide(),void 0;this.element.empty();var a=this,i=this.get("itemTemplate"),o=this.get("dataKey");e.each(t,function(t,r){var s=o?r[o]:r;a.element.append(e(i.replace("{{value}}",s)).data("item",r))}),this.show()},_touchstart:function(){this.touchState="start",this._hideTimer&&clearTimeout(this.hideTimer)},_touchmove:function(){this.touchState="move"},_touchend:function(t){if("start"===this.touchState){var a=e(t.currentTarget).data("item"),i=this.get("dataKey"),o=i?a[i]:a;this.get("trigger").val(o),setTimeout(e.proxy(this,"hide"),360)}},_click:function(t){var a=e(t.currentTarget).data("item"),i=this.get("dataKey"),o=i?a[i]:a;this.get("trigger").val(o),this.hide()},show:function(){this.element.show(),this.trigger("show")},hide:function(){this.element.hide(),this.trigger("hide")}});return o});
