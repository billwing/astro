define("gallery/handsontable/0.9.12/handsontable",["$"],function(a,b,c){var d=this.jQuery;this.jQuery=a("$");var e={extension:{},helper:{}};!function(a,d,e){"use strict";function f(a){this.instance=a,this.createElements(),this.bindEvents()}function g(a){this.instance=a,this.createElements(),this.bindEvents(),this.emptyStringLabel="   "}function h(a,b,c,d){e.helper.stringify(a.getDataAtRowProp(b,c))===e.helper.stringify(d.checkedTemplate)?a.setDataAtRowProp(b,c,d.uncheckedTemplate):a.setDataAtRowProp(b,c,d.checkedTemplate)}function i(b){if(!a.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");this.isCellEdited=!1,this.instance=b,this.createElements(),this.bindEvents()}function j(a){this.instance=a,this.createElements(),this.bindEvents()}function k(){function a(a){return function(b,c){return b[1]===c[1]?0:null===b[1]?1:null===c[1]?-1:b[1]<c[1]?a?-1:1:b[1]>c[1]?a?1:-1:0}}function b(a){return function(b,c){if(b[1]===c[1])return 0;if(null===b[1])return 1;if(null===c[1])return-1;var d=new Date(b[1]),e=new Date(c[1]);return e>d?a?-1:1:d>e?a?1:-1:0}}var c,d=this;this.init=function(a){var b,e,h=this,i=h.getSettings().columnSorting;if(c=!!i){h.sortIndex=[];var j=f.call(h);"undefined"!=typeof j?(b=j.sortColumn,e=j.sortOrder):(b=i.column,e=i.sortOrder),d.sortByColumn.call(h,b,e),h.sort=function(){var a=Array.prototype.slice.call(arguments);return d.sortByColumn.apply(h,a)},"afterInit"==a&&(g.call(h),h.addHook("afterCreateRow",d.afterCreateRow),h.addHook("afterRemoveRow",d.afterRemoveRow))}else delete h.sort},this.setSortingColumn=function(a,b){var c=this;return"undefined"==typeof a?(delete c.sortColumn,delete c.sortOrder,void 0):(c.sortOrder=c.sortColumn===a&&"undefined"==typeof b?!c.sortOrder:"undefined"!=typeof b?b:!0,c.sortColumn=a,void 0)},this.sortByColumn=function(a,b){var c=this;d.setSortingColumn.call(c,a,b),c.PluginHooks.run("beforeColumnSort",c.sortColumn,c.sortOrder),d.sort.call(c),c.render(),e.call(c),c.PluginHooks.run("afterColumnSort",c.sortColumn,c.sortOrder)};var e=function(){var a=this,b={};"undefined"!=typeof a.sortColumn&&(b.sortColumn=a.sortColumn),"undefined"!=typeof a.sortOrder&&(b.sortOrder=a.sortOrder),(b.hasOwnProperty("sortColumn")||b.hasOwnProperty("sortOrder"))&&a.PluginHooks.run("persistentStateSave","columnSorting",b)},f=function(){var a=this,b={};return a.PluginHooks.run("persistentStateLoad","columnSorting",b),b.value},g=function(){function a(){var a=c.view.TBODY.querySelector("tr").querySelectorAll("th");return a.length}function b(b){var d=c.view.wt.wtDom.closest(b,"TH");return c.view.wt.wtDom.index(d)-a()}var c=this;c.rootElement.on("click.handsontable",".columnSorting",function(a){if(c.view.wt.wtDom.hasClass(a.target,"columnSorting")){var e=b(a.target);d.sortByColumn.call(c,e)}})};this.sort=function(){var d=this;if("undefined"!=typeof d.sortOrder){c=!1,d.sortIndex.length=0;for(var e=this.colOffset(),f=0,g=this.countRows()-d.getSettings().minSpareRows;g>f;f++)this.sortIndex.push([f,d.getDataAtCell(f,this.sortColumn+e)]);var h,i=d.getCellMeta(0,d.sortColumn);switch(i.type){case"date":h=b;break;default:h=a}this.sortIndex.sort(h(d.sortOrder));for(var f=this.sortIndex.length;f<d.countRows();f++)this.sortIndex.push([f,d.getDataAtCell(f,this.sortColumn+e)]);c=!0}},this.translateRow=function(a){return c&&this.sortIndex&&this.sortIndex.length?this.sortIndex[a][0]:a},this.onBeforeGetSet=function(a){var b=this;a.row=d.translateRow.call(b,a.row)},this.untranslateRow=function(a){if(c&&this.sortIndex&&this.sortIndex.length)for(var b=0;b<this.sortIndex.length;b++)if(this.sortIndex[b][0]==a)return b},this.getColHeader=function(a,b){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(b.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(a){var b=this;b.sortIndex.splice(a,0,[a,b.getData()[a][this.sortColumn+b.colOffset()]]);for(var c=0;c<b.sortIndex.length;c++)c!=a&&b.sortIndex[c][0]>=a&&(b.sortIndex[c][0]+=1);e.call(b)},this.afterRemoveRow=function(a,b){var c=this;c.sortIndex.splice(a,b);for(var d=0;d<c.sortIndex.length;d++)c.sortIndex[d][0]>a&&(c.sortIndex[d][0]-=b);e.call(c)},this.afterChangeSort=function(a){var b=this,c=!1,e={};if(a){for(var f=0;f<a.length;f++)if(a[f][1]==b.sortColumn){c=!0,e.row=d.translateRow.call(b,a[f][0]),e.col=a[f][1];break}c&&setTimeout(function(){d.sort.call(b),b.render(),b.selectCell(d.untranslateRow.call(b,e.row),e.col)},0)}}}function l(){var b,c,d,e,f,g=document.createElement("DIV"),h=g.style;g.className="ghost",h.position="absolute",h.top="25px",h.left=0,h.width="10px",h.height="10px",h.backgroundColor="#CCC",h.opacity=.7;var i=function(){var a=this;a.PluginHooks.run("persistentStateSave","manualColumnPositions",a.manualColumnPositions)},j=function(){var a=this,b={};return a.PluginHooks.run("persistentStateLoad","manualColumnPositions",b),b.value},k=function(){var j=this;a(document).on("mousemove."+j.guid,function(a){b&&(h.left=f+a.pageX-e+6+"px","none"===h.display&&(h.display="block"))}),a(document).on("mouseup."+j.guid,function(){b&&(d>c&&d--,j.getSettings().rowHeaders&&(c--,d--),j.manualColumnPositions.splice(d,0,j.manualColumnPositions.splice(c,1)[0]),a(".manualColumnMover.active").removeClass("active"),b=!1,j.forceFullRender=!0,j.view.render(),h.display="none",i.call(j),j.PluginHooks.run("afterColumnMove",c,d))}),this.rootElement.on("mousedown."+j.guid,".manualColumnMover",function(a){var d=a.currentTarget,i=j.view.wt.wtDom.closest(d,"TH");c=j.view.wt.wtDom.index(i)+j.colOffset(),b=!0,e=a.pageX;var k=j.$table[0];k.parentNode.appendChild(g),h.width=j.view.wt.wtDom.outerWidth(i)+"px",h.height=j.view.wt.wtDom.outerHeight(k)+"px",f=parseInt(j.view.wt.wtDom.offset(i).left-j.view.wt.wtDom.offset(k).left,10),h.left=f+6+"px"}),this.rootElement.on("mouseenter."+j.guid,"td, th",function(){if(b){var a=j.view.THEAD.querySelector(".manualColumnMover.active");a&&j.view.wt.wtDom.removeClass(a,"active"),d=j.view.wt.wtDom.index(this)+j.colOffset();var c=j.view.THEAD.querySelectorAll("th"),e=c[d].querySelector(".manualColumnMover");j.view.wt.wtDom.addClass(e,"active")}}),j.addHook("afterDestroy",l)},l=function(){var b=this;a(document).off("mouseup."+b.guid),a(document).off("mousemove."+b.guid),b.rootElement.off("mousedown."+b.guid),b.rootElement.off("mouseenter."+b.guid)};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(a){var b=this,c=!!this.getSettings().manualColumnMove;if(c){var d=this.getSettings().manualColumnMove,e=j.call(b);this.manualColumnPositions="undefined"!=typeof e?e:d instanceof Array?d:[],b.forceFullRender=!0,"afterInit"==a&&(k.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else l.call(this),this.manualColumnPositions=[]},this.modifyCol=function(a){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[a]&&(this.manualColumnPositions[a]=a),this.manualColumnPositions[a]):a},this.getColHeader=function(a,b){if(this.getSettings().manualColumnMove){var c=document.createElement("DIV");c.className="manualColumnMover",b.firstChild.appendChild(c)}}}function m(){function b(a){j=this,f=a;var b=this.view.wt.wtTable.getCoords(a)[1];if(b>=0){g=b;var d=this.view.wt.wtDom.offset(this.rootElement[0]).left,e=this.view.wt.wtDom.offset(a).left;n=e-d-6,p.style.left=n+c.call(j,a)+"px",this.rootElement[0].appendChild(p)}}function c(a){var b=this,c=b.view.wt.wtDom.offset(a).left-b.view.wt.wtDom.offset(a).left,d=b.view.wt.wtDom.offset(b.rootElement[0]).left,e=b.view.wt.wtTable.getCoords(a)[1],f=b.getColWidth(e),g=b.view.maximumVisibleElementWidth(c-d);return Math.min(f,g)}function d(){m=c.call(this,f),this.view.wt.wtDom.addClass(p,"active"),s.height=this.view.wt.wtDom.outerHeight(this.$table[0])+"px",e=!0}var e,f,g,h,i,j,k,l,m,n,o=0,p=document.createElement("DIV"),q=document.createElement("DIV"),r=document.createElement("DIV"),s=r.style;p.className="manualColumnResizer",q.className="manualColumnResizerHandle",p.appendChild(q),r.className="manualColumnResizerLine",p.appendChild(r);var t=a(document);t.mousemove(function(a){e&&(h=m+(a.pageX-l),k=x(g,h),p.style.left=n+h+"px")}),t.mouseup(function(){e&&(j.view.wt.wtDom.removeClass(p,"active"),e=!1,j.forceFullRender=!0,j.view.render(),u.call(j),j.PluginHooks.run("afterColumnResize",g,k),b.call(j,f))});var u=function(){var a=this;a.PluginHooks.run("persistentStateSave","manualColumnWidths",a.manualColumnWidths)},v=function(){var a=this,b={};return a.PluginHooks.run("persistentStateLoad","manualColumnWidths",b),b.value},w=function(){var a=this;this.rootElement.on("mouseenter.handsontable","th",function(c){e||b.call(a,c.currentTarget)}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){null==i&&(i=setTimeout(function(){o>=2&&(x(g,htAutoColumnSize.determineColumnWidth.call(a,g)),a.forceFullRender=!0,a.view.render(),a.PluginHooks.run("afterColumnResize",g,k)),o=0,i=null},500)),o++}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(b){l=b.pageX,d.call(a)})};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(a){var b=this,c=!!this.getSettings().manualColumnResize;if(c){var d=this.getSettings().manualColumnResize,e=v.call(b);this.manualColumnWidths="undefined"!=typeof e?e:d instanceof Array?d:[],"afterInit"==a&&(w.call(this),b.forceFullRender=!0,b.render())}};var x=function(a,b){return b=Math.max(b,20),a=j.PluginHooks.execute("modifyCol",a),j.manualColumnWidths[a]=b,b};this.getColWidth=function(a,b){this.getSettings().manualColumnResize&&this.manualColumnWidths[a]&&(b.width=this.manualColumnWidths[a])}}function n(){this.init=function(){var a=this,b=a.getSettings().observeChanges;!a.observer&&b?a.observer=U.observe(a.getData(),function(){a.render()}):a.observer&&!b&&U.unobserve(a.getData(),a.observer)}}function o(a){var b,c=function(){d.localStorage[a+"__"+"persistentStateKeys"]=JSON.stringify(b)},e=function(){var c=d.localStorage[a+"__"+"persistentStateKeys"],e="string"==typeof c?JSON.parse(c):void 0;b=e?e:[]},f=function(){b=[],c()};e(),this.saveValue=function(e,f){d.localStorage[a+"_"+e]=JSON.stringify(f),-1==b.indexOf(e)&&(b.push(e),c())},this.loadValue=function(b,c){b="undefined"!=typeof b?b:c;var e=d.localStorage[a+"_"+b];return"undefined"==typeof e?void 0:JSON.parse(e)},this.reset=function(b){d.localStorage.removeItem(a+"_"+b)},this.resetAll=function(){for(var c=0;c<b.length;c++)d.localStorage.removeItem(a+"_"+b[c]);f()}}function p(){var a,b,c=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[];var d=document.documentElement;b=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",a=this.elDiv.style,a.position="fixed",a.top=0,a.left=0,b.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",a=this.elTextarea.style,a.width="1px",a.height="1px",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof a.opacity&&(a.opacity=0)),this._bindEvent(d,"keydown",function(a){var b=!1;if(a.metaKey?b=!0:a.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(b=!0),b){if(document.activeElement!==c.elTextarea&&(""!=c.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;c.selectNodeText(c.elTextarea),setTimeout(function(){c.selectNodeText(c.elTextarea)},0)}!b||67!==a.keyCode&&86!==a.keyCode&&88!==a.keyCode||(88===a.keyCode?setTimeout(function(){c.triggerCut(a)},0):86===a.keyCode&&setTimeout(function(){c.triggerPaste(a)},0))})}function q(b,c){var d;this.instance=b,this.settings=c,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),d=this.main.style,d.position="absolute",d.top=0,d.left=0;for(var e=0;5>e;e++){var f=document.createElement("DIV");f.className="wtBorder "+(c.className||""),d=f.style,d.backgroundColor=c.border.color,d.height=c.border.width+"px",d.width=c.border.width+"px",this.main.appendChild(f)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),b.wtTable.bordersHolder||(b.wtTable.bordersHolder=document.createElement("div"),b.wtTable.bordersHolder.className="htBorders",b.wtTable.hider.appendChild(b.wtTable.bordersHolder)),b.wtTable.bordersHolder.appendChild(this.main);var g=!1,h=a(document.body);h.on("mousedown.walkontable."+b.guid,function(){g=!0}),h.on("mouseup.walkontable."+b.guid,function(){g=!1}),a(this.main.childNodes).on("mouseenter",function(c){if(g&&b.getSetting("hideBorderOnMouseDownOver")){c.preventDefault(),c.stopImmediatePropagation();var d=this.getBoundingClientRect(),e=a(this);e.hide();var f=function(a){return a.clientY<Math.floor(d.top)?!0:a.clientY>Math.ceil(d.top+d.height)?!0:a.clientX<Math.floor(d.left)?!0:a.clientX>Math.ceil(d.left+d.width)?!0:void 0};h.on("mousemove.border."+b.guid,function(a){f(a)&&(h.off("mousemove.border."+b.guid),e.show())})}})}function r(){this.offset=0,this.total=0,this.fixedCount=0}function s(){}function t(){this.cache=[]}function u(){this.countTH=0}function v(a,b,c){var d,e=0;for(this.containerSizeFn=a,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=c;;){if(d=b(e),void 0===d)break;if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+d))break;this.cellSizes.push(d),this.cellSizesSum+=d,this.cellCount++,e++}var f=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-f}function w(a){var b=this,c=[];if(this.guid="wt_"+(d.Handsontable?e.helper.randomString():""),this.wtSettings=new G(this,a),this.wtDom=new x,this.wtTable=new H(this),this.wtScroll=new B(this),this.wtScrollbars=new E(this),this.wtViewport=new I(this),this.wtWheel=new J(this),this.wtEvent=new y(this),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var f=0,g=this.wtTable.THEAD.childNodes[0].childNodes.length;g>f;f++)c.push(this.wtTable.THEAD.childNodes[0].childNodes[f].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(a,d){b.wtDom.fastInnerText(d,c[a])}])}this.selections={};var h=this.getSetting("selections");if(h)for(var i in h)h.hasOwnProperty(i)&&(this.selections[i]=new F(this,h[i]));this.drawn=!1,this.drawInterrupted=!1}function x(){}function y(b){var c=this;this.instance=b,this.wtDom=this.instance.wtDom;var d=[null,null,null,null];this.instance.dblClickTimeout=null;var e,f=function(a){var b=c.parentCell(a.target);b.TD&&"TD"===b.TD.nodeName?c.instance.hasSetting("onCellMouseDown")&&c.instance.getSetting("onCellMouseDown",a,b.coords,b.TD):c.wtDom.hasClass(a.target,"corner")&&c.instance.getSetting("onCellCornerMouseDown",a,a.target),2!==a.button&&(b.TD&&"TD"===b.TD.nodeName?(d.shift(),d.push(b.TD)):c.wtDom.hasClass(a.target,"corner")&&(d.shift(),d.push(a.target)))},g=function(a){if(c.instance.hasSetting("onCellMouseOver")){var b=c.instance.wtTable.TABLE,d=c.wtDom.closest(a.target,["TD","TH"],b);d&&d!==e&&c.wtDom.isChildOf(d,b)&&(e=d,"TD"===d.nodeName&&c.instance.getSetting("onCellMouseOver",a,c.instance.wtTable.getCoords(d),d))}},h=function(a){if(2!==a.button){var b=c.parentCell(a.target);b.TD&&"TD"===b.TD.nodeName?(d.shift(),d.push(b.TD)):(d.shift(),d.push(a.target)),null!==d[3]&&d[3]===d[2]&&(c.instance.dblClickTimeout&&d[2]===d[1]&&d[1]===d[0]?(b.TD?c.instance.getSetting("onCellDblClick",a,b.coords,b.TD):c.wtDom.hasClass(a.target,"corner")&&c.instance.getSetting("onCellCornerDblClick",a,b.coords,b.TD),clearTimeout(c.instance.dblClickTimeout),c.instance.dblClickTimeout=null):(clearTimeout(c.instance.dblClickTimeout),c.instance.dblClickTimeout=setTimeout(function(){c.instance.dblClickTimeout=null},500)))}};a(this.instance.wtTable.parent).on("mousedown",f),a(this.instance.wtTable.TABLE).on("mouseover",g),a(this.instance.wtTable.parent).on("mouseup",h)}function z(){}function A(a,b){this.containerSizeFn=a,this.sizeAtIndex=b,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.remainingSize=-1/0}function B(a){this.instance=a}function C(){}function D(){this.lastWindowScrollPosition=0/0}function E(a){switch(a.getSetting("scrollbarModelV")){case"dragdealer":this.vertical=new V(a);break;case"native":this.vertical=new X(a)}switch(a.getSetting("scrollbarModelH")){case"dragdealer":this.horizontal=new W(a);break;case"native":this.horizontal=new Y(a)}}function F(a,b){this.instance=a,this.settings=b,this.selected=[],b.border&&(this.border=new q(a,b))}function G(a,b){var c=this;this.instance=a,this.defaults={table:void 0,scrollH:"auto",scrollV:"auto",scrollbarModelH:"dragdealer",scrollbarModelV:"dragdealer",stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(a,b,d){var e=c.getSetting("data",a,b);c.instance.wtDom.fastInnerText(d,void 0===e||null===e?"":e)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,scrollbarWidth:10,scrollbarHeight:10},this.settings={};for(var d in this.defaults)if(this.defaults.hasOwnProperty(d))if(void 0!==b[d])this.settings[d]=b[d];else{if(void 0===this.defaults[d])throw new Error('A required setting "'+d+'" was not provided');this.settings[d]=this.defaults[d]}}function H(a){this.instance=a,this.TABLE=this.instance.getSetting("table"),this.wtDom=this.instance.wtDom,this.wtDom.removeTextNodes(this.TABLE);var b=this.TABLE.parentNode;if(!b||1!==b.nodeType||!this.wtDom.hasClass(b,"wtHolder")){var c=document.createElement("DIV");c.className="wtSpreader",b&&b.insertBefore(c,this.TABLE),c.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,b=this.spreader.parentNode,!b||1!==b.nodeType||!this.wtDom.hasClass(b,"wtHolder")){var d=document.createElement("DIV");d.className="wtHider",b&&b.insertBefore(d,this.spreader),d.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",b=this.hider.parentNode,!b||1!==b.nodeType||!this.wtDom.hasClass(b,"wtHolder")){var e=document.createElement("DIV");e.style.position="relative",e.className="wtHolder",b&&b.insertBefore(e,this.hider),e.appendChild(this.hider)}if(this.parent=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var f=document.createElement("TR");this.THEAD.appendChild(f)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new t,this.currentCellCache=new t,this.rowFilter=new z,this.columnFilter=new u,this.verticalRenderReverse=!1}function I(a){this.instance=a,this.resetSettings()}function J(b){"native"!==b.getSetting("scrollbarModelV")&&"native"!==b.getSetting("scrollbarModelH")&&a(b.wtTable.spreader).on("mousewheel",function(a,c,d,e){d||e||!c||(e=c),(d||e)&&(e>0&&0===b.getSetting("offsetRow")||0>e&&b.wtTable.isLastRowFullyVisible()||0>d&&0===b.getSetting("offsetColumn")||d>0&&b.wtTable.isLastColumnFullyVisible()||(clearTimeout(b.wheelTimeout),b.wheelTimeout=setTimeout(function(){e?b.wtScrollbars.vertical.visible&&b.scrollVertical(-Math.ceil(e)).draw():d&&b.wtScrollbars.horizontal.visible&&b.scrollHorizontal(Math.ceil(d)).draw()},0),a.preventDefault()))})}e.activeGuid=null,e.Core=function(b,c){function f(){var a=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,a=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==a&&(a=!0,this.onQueueEmpty())}}}function g(b,c,d){function e(){var e;b.length&&(e=q.PluginHooks.execute("beforeChange",b,c),"function"==typeof e?a.when(result).then(function(){d()}):e===!1&&b.splice(0,b.length)),"function"!=typeof e&&d()}var g=new f;g.onQueueEmpty=e;for(var h=b.length-1;h>=0;h--)if(null===b[h])b.splice(h,1);else{var i=q.getCellMeta(b[h][0],l.propToCol(b[h][1]));"number"===i.dataType&&"string"==typeof b[h][3]&&b[h][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(b[h][3])&&(b[h][3]=numeral().unformat(b[h][3]||"0")),i.validator&&(g.addValidatorToQueue(),q.validateCell(b[h][3],i,function(a,c){return function(d){if("boolean"!=typeof d)throw new Error("Validation error: result is not boolean");d===!1&&c.allowInvalid===!1&&(b.splice(a,1),--a),g.removeValidatorFormQueue()}}(h,i),c))}g.checkIfQueueIsEmpty()}function h(a,b){var c=a.length-1;if(!(0>c)){for(;c>=0;c--)if(null!==a[c]){if(k.settings.minSpareRows)for(;a[c][0]>q.countRows()-1;)l.createRow();if("array"===k.dataType&&k.settings.minSpareCols)for(;l.propToCol(a[c][1])>q.countCols()-1;)l.createCol();l.set(a[c][0],a[c][1],a[c][3])}else a.splice(c,1);q.forceFullRender=!0,m.adjustRowsAndCols(),n.refreshBorders(null,!0),q.PluginHooks.run("afterChange",a,b||"edit")}}function i(b,c,d){return"object"==typeof b?b:a.isPlainObject(d)?d:[[b,c,d]]}function j(a){if(a.hasOwnProperty("type")){var b,c;if("object"==typeof a.type)b=a.type;else if("string"==typeof a.type&&(b=e.cellTypes[a.type],void 0===b))throw new Error('You declared cell type "'+a.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(c in b)b.hasOwnProperty(c)&&!a.hasOwnProperty(c)&&(a[c]=b[c])}}var k,l,m,n,o,p,q=this,r=function(){};e.helper.inherit(r,K),e.helper.extend(r.prototype,e.TextCell),j(c),e.helper.extend(r.prototype,c),this.rootElement=b;var s=a(document.documentElement),t=a(document.body);this.guid="ht_"+e.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),k={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new r,settingsFromDOM:{},selStart:new e.SelectionPoint,selEnd:new e.SelectionPoint,editProxy:!1,isPopulated:null,scrollable:null,undoRedo:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:!0},l={recursiveDuckSchema:function(b){var c;if(a.isPlainObject(b)){c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.isPlainObject(b[d])?l.recursiveDuckSchema(b[d]):null)}else c=[];return c},recursiveDuckColumns:function(b,c,d){var e,f;if("undefined"==typeof c&&(c=0,d=""),a.isPlainObject(b))for(f in b)b.hasOwnProperty(f)&&(null===b[f]?(e=d+f,k.colToProp.push(e),k.propToCol[e]=c,c++):c=l.recursiveDuckColumns(b[f],c,f+"."));return c},createMap:function(){if("undefined"==typeof l.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var a,b,c=l.getSchema();if(k.colToProp=[],k.propToCol={},k.settings.columns)for(a=0,b=k.settings.columns.length;b>a;a++)k.colToProp[a]=k.settings.columns[a].data,k.propToCol[k.settings.columns[a].data]=a;else l.recursiveDuckColumns(c)},colToProp:function(a){return a=e.PluginHooks.execute(q,"modifyCol",a),k.colToProp&&"undefined"!=typeof k.colToProp[a]?k.colToProp[a]:a},propToCol:function(a){var b;return b="undefined"!=typeof k.propToCol[a]?k.propToCol[a]:a,b=e.PluginHooks.execute(q,"modifyCol",b)},getSchema:function(){return k.settings.dataSchema?"function"==typeof k.settings.dataSchema?k.settings.dataSchema():k.settings.dataSchema:k.duckDataSchema},createRow:function(b){var c,d=q.countRows();if(("number"!=typeof b||b>=d)&&(b=d),"array"===k.dataType){c=[];for(var e=0,f=q.countCols();f>e;e++)c.push(null)}else c="function"===k.dataType?k.settings.dataSchema(b):a.extend(!0,{},l.getSchema());b===d?r.prototype.data.push(c):r.prototype.data.splice(b,0,c),q.PluginHooks.run("afterCreateRow",b),q.forceFullRender=!0},createCol:function(a){if("object"===k.dataType||k.settings.columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting");var b=0,c=q.countRows(),d=r.prototype.data,f=e.helper.columnFactory(r,k.columnsSettingConflicts);if("number"!=typeof a||a>=q.countCols()){for(;c>b;b++)"undefined"==typeof d[b]&&(d[b]=[]),d[b].push(null);k.columnSettings.push(f)}else{for(;c>b;b++)d[b].splice(a,0,null);k.columnSettings.splice(a,0,f)}q.PluginHooks.run("afterCreateCol",a),q.forceFullRender=!0},removeRow:function(a,b){b||(b=1),"number"!=typeof a&&(a=-b);var c=this.physicalRowsToLogical(a,b);r.prototype.data=r.prototype.data.filter(function(a,b){return-1==c.indexOf(b)}),q.PluginHooks.run("afterRemoveRow",a,b),q.forceFullRender=!0},removeCol:function(a,b){if("object"===k.dataType||k.settings.columns)throw new Error("cannot remove column with object data source or columns option specified");b||(b=1),"number"!=typeof a&&(a=-b);for(var c=r.prototype.data,d=0,e=q.countRows();e>d;d++)c[d].splice(a,b);q.PluginHooks.run("afterRemoveCol",a,b),k.columnSettings.splice(a,b),q.forceFullRender=!0},spliceCol:function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],f=q.getDataAtCol(a),g=f.slice(b,b+c),h=f.slice(b+c);e.helper.extendArray(d,h);for(var i=0;c>i;)d.push(null),i++;return e.helper.to2dArray(d),q.populateFromArray(b,a,d,null,null,"spliceCol"),g},spliceRow:function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],f=q.getDataAtRow(a),g=f.slice(b,b+c),h=f.slice(b+c);e.helper.extendArray(d,h);for(var i=0;c>i;)d.push(null),i++;return q.populateFromArray(a,b,[d],null,null,"spliceRow"),g},getVars:{},get:function(a,b){if(l.getVars.row=a,l.getVars.prop=b,q.PluginHooks.run("beforeGet",l.getVars),"string"==typeof l.getVars.prop&&l.getVars.prop.indexOf(".")>-1){var c=l.getVars.prop.split("."),d=k.settings.data[l.getVars.row];if(!d)return null;for(var e=0,f=c.length;f>e;e++)if(d=d[c[e]],"undefined"==typeof d)return null;return d}return"function"==typeof l.getVars.prop?l.getVars.prop(k.settings.data.slice(l.getVars.row,l.getVars.row+1)[0]):k.settings.data[l.getVars.row]?k.settings.data[l.getVars.row][l.getVars.prop]:null},setVars:{},set:function(a,b,c,d){if(l.setVars.row=a,l.setVars.prop=b,l.setVars.value=c,q.PluginHooks.run("beforeSet",l.setVars,d||"datamapGet"),"string"==typeof l.setVars.prop&&l.setVars.prop.indexOf(".")>-1){for(var e=l.setVars.prop.split("."),f=k.settings.data[l.setVars.row],g=0,h=e.length-1;h>g;g++)f=f[e[g]];f[e[g]]=l.setVars.value}else"function"==typeof l.setVars.prop?l.setVars.prop(k.settings.data.slice(l.setVars.row,l.setVars.row+1)[0],l.setVars.value):k.settings.data[l.setVars.row][l.setVars.prop]=l.setVars.value},physicalRowsToLogical:function(a,b){for(var c=(r.prototype.data.length+a)%r.prototype.data.length,d=[],e=b;c<r.prototype.data.length&&e;)this.get(c,0),d.push(this.getVars.row),e--,c++;return d},clear:function(){for(var a=0;a<q.countRows();a++)for(var b=0;b<q.countCols();b++)l.set(a,l.colToProp(b),"")},getAll:function(){return k.settings.data},getRange:function(a,b){var c,d,e,f,g,h=[];for(d=Math.max(a.row,b.row),f=Math.max(a.col,b.col),c=Math.min(a.row,b.row);d>=c;c++){for(g=[],e=Math.min(a.col,b.col);f>=e;e++)g.push(l.get(c,l.colToProp(e)));h.push(g)}return h},getText:function(a,b){return SheetClip.stringify(l.getRange(a,b))}},m={alter:function(b,c,d,e,f){var g,h,i,j,o,p,r,s;switch(g=a.extend(!0,[],l.getAll()),b){case"insert_row":for(d||(d=1),s=0;d>s&&q.countRows()<k.settings.maxRows;)l.createRow(c),s++;s&&(k.selStart.exists()&&k.selStart.row()>=c?(k.selStart.row(k.selStart.row()+s),n.transformEnd(s,0)):n.refreshBorders());break;case"insert_col":for(d||(d=1),s=0;d>s&&q.countCols()<k.settings.maxCols;)l.createCol(c),s++;s&&(k.selStart.exists()&&k.selStart.col()>=c?(k.selStart.col(k.selStart.col()+s),n.transformEnd(0,s)):n.refreshBorders());break;case"remove_row":l.removeRow(c,d),m.adjustRowsAndCols(),n.refreshBorders();break;case"remove_col":l.removeCol(c,d),m.adjustRowsAndCols(),n.refreshBorders();break;default:throw new Error('There is no such action "'+b+'"')}for(i=[],h=l.getAll(),j=0,o=h.length;o>j;j++)for(p=0,r=h[j].length;r>p;p++)i.push([j,p,g[j]?g[j][p]:null,h[j][p]]);q.PluginHooks.run("afterChange",i,e||b),f||m.adjustRowsAndCols()},adjustRowsAndCols:function(){var a,b,c,d=q.countEmptyRows(!0);if(b=q.countRows(),b<k.settings.minRows)for(a=0;a<k.settings.minRows-b;a++)l.createRow();if(d<k.settings.minSpareRows)for(;d<k.settings.minSpareRows&&q.countRows()<k.settings.maxRows;d++)l.createRow();if(c=q.countEmptyCols(!0),!k.settings.columns&&q.countCols()<k.settings.minCols)for(;q.countCols()<k.settings.minCols;c++)l.createCol();if(!k.settings.columns&&"array"===k.dataType&&c<k.settings.minSpareCols)for(;c<k.settings.minSpareCols&&q.countCols()<k.settings.maxCols;c++)l.createCol();if(k.settings.enterBeginsEditing)for(;(k.settings.minRows||k.settings.minSpareRows)&&q.countRows()>k.settings.minRows&&k.settings.minSpareRows&&d>k.settings.minSpareRows;d--)l.removeRow();if(k.settings.enterBeginsEditing&&!k.settings.columns)for(;(k.settings.minCols||k.settings.minSpareCols)&&q.countCols()>k.settings.minCols&&k.settings.minSpareCols&&c>k.settings.minSpareCols;c--)l.removeCol();var e=q.countRows(),f=q.countCols();if((0===e||0===f)&&n.deselect(),k.selStart.exists()){var g,h=k.selStart.row(),i=k.selStart.col(),j=k.selEnd.row(),m=k.selEnd.col();h>e-1?(h=e-1,g=!0,j>h&&(j=h)):j>e-1&&(j=e-1,g=!0,h>j&&(h=j)),i>f-1?(i=f-1,g=!0,m>i&&(m=i)):m>f-1&&(m=f-1,g=!0,i>m&&(i=m)),g&&q.selectCell(h,i,j,m)}},populateFromArray:function(a,b,c,d,f){var g,h,i,j,l=[],m={};if(h=b.length,0===h)return!1;var n,o,p,r;switch(f){case"shift_down":for(n=c?c.col-a.col+1:0,o=c?c.row-a.row+1:0,b=e.helper.translateRowsToColumns(b),i=0,j=b.length,p=Math.max(j,n);p>i;i++)if(j>i){for(g=0,h=b[i].length;o-h>g;g++)b[i].push(b[i][g%h]);b[i].unshift(a.col+i,a.row,0),q.spliceCol.apply(q,b[i])}else b[i%j][0]=a.col+i,q.spliceCol.apply(q,b[i%j]);break;case"shift_right":for(n=c?c.col-a.col+1:0,o=c?c.row-a.row+1:0,g=0,h=b.length,r=Math.max(h,o);r>g;g++)if(h>g){for(i=0,j=b[g].length;n-j>i;i++)b[g].push(b[g][i%j]);b[g].unshift(a.row+g,a.col,0),q.spliceRow.apply(q,b[g])}else b[g%h][0]=a.row+g,q.spliceRow.apply(q,b[g%h]);break;case"overwrite":default:for(m.row=a.row,m.col=a.col,g=0;h>g&&!(c&&m.row>c.row||!k.settings.minSpareRows&&m.row>q.countRows()-1||m.row>=k.settings.maxRows);g++){for(m.col=a.col,j=b[g]?b[g].length:0,i=0;j>i&&!(c&&m.col>c.col||!k.settings.minSpareCols&&m.col>q.countCols()-1||m.col>=k.settings.maxCols);i++)q.getCellMeta(m.row,m.col).readOnly||l.push([m.row,m.col,b[g][i]]),m.col++,c&&i===j-1&&(i=-1);m.row++,c&&g===h-1&&(g=-1)}q.setDataAtCell(l,null,null,d||"populateFromArray")}},getCornerCoords:function(b){function c(b,c,d){function e(a){return a[d]}return Array.prototype.map?b.apply(Math,c.map(e)):b.apply(Math,a.map(c,e))}return{TL:{row:c(Math.min,b,"row"),col:c(Math.min,b,"col")},BR:{row:c(Math.max,b,"row"),col:c(Math.max,b,"col")}}},getCellsAtCoords:function(a,b){var c,d,e=m.getCornerCoords([a,b]),f=[];
for(c=e.TL.row;c<=e.BR.row;c++)for(d=e.TL.col;d<=e.BR.col;d++)f.push(q.view.getCellAtCoords({row:c,col:d}));return f}},this.selection=n={inProgress:!1,begin:function(){q.selection.inProgress=!0},finish:function(){var a=q.getSelected();q.PluginHooks.run("afterSelectionEnd",a[0],a[1],a[2],a[3]),q.PluginHooks.run("afterSelectionEndByProp",a[0],q.colToProp(a[1]),a[2],q.colToProp(a[3])),q.selection.inProgress=!1},isInProgress:function(){return q.selection.inProgress},setRangeStart:function(a){k.selStart.coords(a),n.setRangeEnd(a)},setRangeEnd:function(a,b){q.selection.begin(),k.selEnd.coords(a),k.settings.multiSelect||k.selStart.coords(a),q.view.wt.selections.current.clear(),q.view.wt.selections.current.add(k.selStart.arr()),q.view.wt.selections.area.clear(),n.isMultiple()&&(q.view.wt.selections.area.add(k.selStart.arr()),q.view.wt.selections.area.add(k.selEnd.arr())),(k.settings.currentRowClassName||k.settings.currentColClassName)&&(q.view.wt.selections.highlight.clear(),q.view.wt.selections.highlight.add(k.selStart.arr()),q.view.wt.selections.highlight.add(k.selEnd.arr())),q.PluginHooks.run("afterSelection",k.selStart.row(),k.selStart.col(),k.selEnd.row(),k.selEnd.col()),q.PluginHooks.run("afterSelectionByProp",k.selStart.row(),l.colToProp(k.selStart.col()),k.selEnd.row(),l.colToProp(k.selEnd.col())),b!==!1&&q.view.scrollViewport(a),n.refreshBorders()},refreshBorders:function(a,b){b||o.destroy(a),q.view.render(),n.isSelected()&&!b&&o.prepare()},isMultiple:function(){return!(k.selEnd.col()===k.selStart.col()&&k.selEnd.row()===k.selStart.row())},transformStart:function(a,b,c){k.selStart.row()+a>q.countRows()-1?c&&k.settings.minSpareRows>0?q.alter("insert_row",q.countRows()):k.settings.autoWrapCol&&k.selStart.col()+b<q.countCols()-1&&(a=1-q.countRows(),b=1):k.settings.autoWrapCol&&k.selStart.row()+a<0&&k.selStart.col()+b>=0&&(a=q.countRows()-1,b=-1),k.selStart.col()+b>q.countCols()-1?c&&k.settings.minSpareCols>0?q.alter("insert_col",q.countCols()):k.settings.autoWrapRow&&k.selStart.row()+a<q.countRows()-1&&(a=1,b=1-q.countCols()):k.settings.autoWrapRow&&k.selStart.col()+b<0&&k.selStart.row()+a>=0&&(a=-1,b=q.countCols()-1);var d=q.countRows(),e=q.countCols(),f={row:k.selStart.row()+a,col:k.selStart.col()+b};f.row<0?f.row=0:f.row>0&&f.row>=d&&(f.row=d-1),f.col<0?f.col=0:f.col>0&&f.col>=e&&(f.col=e-1),n.setRangeStart(f)},transformEnd:function(a,b){if(k.selEnd.exists()){var c=q.countRows(),d=q.countCols(),e={row:k.selEnd.row()+a,col:k.selEnd.col()+b};e.row<0?e.row=0:e.row>0&&e.row>=c&&(e.row=c-1),e.col<0?e.col=0:e.col>0&&e.col>=d&&(e.col=d-1),n.setRangeEnd(e)}},isSelected:function(){return k.selEnd.exists()},inInSelection:function(a){if(!n.isSelected())return!1;var b=m.getCornerCoords([k.selStart.coords(),k.selEnd.coords()]);return b.TL.row<=a.row&&b.BR.row>=a.row&&b.TL.col<=a.col&&b.BR.col>=a.col},deselect:function(){n.isSelected()&&(q.selection.inProgress=!1,k.selEnd=new e.SelectionPoint,q.view.wt.selections.current.clear(),q.view.wt.selections.area.clear(),o.destroy(),n.refreshBorders(),q.PluginHooks.run("afterDeselect"))},selectAll:function(){k.settings.multiSelect&&(n.setRangeStart({row:0,col:0}),n.setRangeEnd({row:q.countRows()-1,col:q.countCols()-1},!1))},empty:function(){if(n.isSelected()){var a,b,c=m.getCornerCoords([k.selStart.coords(),k.selEnd.coords()]),d=[];for(a=c.TL.row;a<=c.BR.row;a++)for(b=c.TL.col;b<=c.BR.col;b++)q.getCellMeta(a,b).readOnly||d.push([a,b,""]);q.setDataAtCell(d)}}},this.autofill=p={handle:null,init:function(){p.handle?p.handle.disabled=!1:p.handle={}},disable:function(){p.handle.disabled=!0},selectAdjacent:function(){var a,b,c,d,e;a=n.isMultiple()?q.view.wt.selections.area.getCorners():q.view.wt.selections.current.getCorners(),b=l.getAll();a:for(c=a[2]+1;c<q.countRows();c++){for(e=a[1];e<=a[3];e++)if(b[c][e])break a;(b[c][a[1]-1]||b[c][a[3]+1])&&(d=c)}d&&(q.view.wt.selections.fill.clear(),q.view.wt.selections.fill.add([a[0],a[1]]),q.view.wt.selections.fill.add([d,a[3]]),p.apply())},apply:function(){var a,b,c,d,e;p.handle.isDragged=0,a=q.view.wt.selections.fill.getCorners(),a&&(q.view.wt.selections.fill.clear(),b=n.isMultiple()?q.view.wt.selections.area.getCorners():q.view.wt.selections.current.getCorners(),a[0]===b[0]&&a[1]<b[1]?(c={row:a[0],col:a[1]},d={row:a[2],col:b[1]-1}):a[0]===b[0]&&a[3]>b[3]?(c={row:a[0],col:b[3]+1},d={row:a[2],col:a[3]}):a[0]<b[0]&&a[1]===b[1]?(c={row:a[0],col:a[1]},d={row:b[0]-1,col:a[3]}):a[2]>b[2]&&a[1]===b[1]&&(c={row:b[2]+1,col:a[1]},d={row:a[2],col:a[3]}),c&&(e=SheetClip.parse(l.getText(k.selStart.coords(),k.selEnd.coords())),q.PluginHooks.run("beforeAutofill",c,d,e),m.populateFromArray(c,e,d,"autofill"),n.setRangeStart({row:a[0],col:a[1]}),n.setRangeEnd({row:a[2],col:a[3]})))},showBorder:function(a){a.row=a[0],a.col=a[1];var b=m.getCornerCoords([k.selStart.coords(),k.selEnd.coords()]);if("horizontal"!==k.settings.fillHandle&&(b.BR.row<a.row||b.TL.row>a.row))a=[a.row,b.BR.col];else{if("vertical"===k.settings.fillHandle)return;a=[b.BR.row,a.col]}q.view.wt.selections.fill.clear(),q.view.wt.selections.fill.add([k.selStart.coords().row,k.selStart.coords().col]),q.view.wt.selections.fill.add([k.selEnd.coords().row,k.selEnd.coords().col]),q.view.wt.selections.fill.add(a),q.view.render()}},o={init:function(){function a(a){if(q.isListening()&&(k.settings.beforeOnKeyDown&&k.settings.beforeOnKeyDown.call(q,a),!Array.prototype.filter.call(document.body.querySelectorAll(".context-menu-list"),q.view.wt.wtDom.isVisible).length)){if(17===a.keyCode||224===a.keyCode||91===a.keyCode||93===a.keyCode)return o.setCopyableText(),void 0;if(k.lastKeyCode=a.keyCode,n.isSelected()){var b=(a.ctrlKey||a.metaKey)&&!a.altKey;if(e.helper.isPrintableChar(a.keyCode)&&b)return 65===a.keyCode?(n.selectAll(),o.setCopyableText(),a.preventDefault()):89===a.keyCode||a.shiftKey&&90===a.keyCode?k.undoRedo&&k.undoRedo.redo():90===a.keyCode&&k.undoRedo&&k.undoRedo.undo(),void 0;var c=a.shiftKey?n.setRangeEnd:n.setRangeStart;if(q.PluginHooks.run("beforeKeyDown",a),!a.isImmediatePropagationStopped())switch(a.keyCode){case 38:a.shiftKey?n.transformEnd(-1,0):n.transformStart(-1,0),a.preventDefault(),a.stopPropagation();break;case 9:var d="function"==typeof k.settings.tabMoves?k.settings.tabMoves(a):k.settings.tabMoves;a.shiftKey?n.transformStart(-d.row,-d.col):n.transformStart(d.row,d.col,!0),a.preventDefault(),a.stopPropagation();break;case 39:a.shiftKey?n.transformEnd(0,1):n.transformStart(0,1),a.preventDefault(),a.stopPropagation();break;case 37:a.shiftKey?n.transformEnd(0,-1):n.transformStart(0,-1),a.preventDefault(),a.stopPropagation();break;case 8:case 46:n.empty(a),a.preventDefault();break;case 40:a.shiftKey?n.transformEnd(1,0):n.transformStart(1,0),a.preventDefault(),a.stopPropagation();break;case 113:a.preventDefault();break;case 13:var f="function"==typeof k.settings.enterMoves?k.settings.enterMoves(a):k.settings.enterMoves;a.shiftKey?n.transformStart(-f.row,-f.col):n.transformStart(f.row,f.col,!0),a.preventDefault();break;case 36:a.ctrlKey||a.metaKey?c({row:0,col:k.selStart.col()}):c({row:k.selStart.row(),col:0}),a.preventDefault(),a.stopPropagation();break;case 35:a.ctrlKey||a.metaKey?c({row:q.countRows()-1,col:k.selStart.col()}):c({row:k.selStart.row(),col:q.countCols()-1}),a.preventDefault(),a.stopPropagation();break;case 33:n.transformStart(-q.countVisibleRows(),0),q.view.wt.scrollVertical(-q.countVisibleRows()),q.view.render(),a.preventDefault(),a.stopPropagation();break;case 34:n.transformStart(q.countVisibleRows(),0),q.view.wt.scrollVertical(q.countVisibleRows()),q.view.render(),a.preventDefault(),a.stopPropagation()}}}}k.onCut=function(){q.isListening()&&n.empty()},k.onPaste=function(a){if(q.isListening()){var b=a.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),c=SheetClip.parse(b),d=m.getCornerCoords([k.selStart.coords(),k.selEnd.coords()]),e=d.TL,f={row:Math.max(d.BR.row,c.length-1+d.TL.row),col:Math.max(d.BR.col,c[0].length-1+d.TL.col)};q.PluginHooks.once("afterChange",function(a){a&&a.length&&q.selectCell(e.row,e.col,f.row,f.col)}),m.populateFromArray(e,c,f,"paste",k.settings.pasteMode)}},q.copyPaste=T.getInstance(),q.copyPaste.onCut(k.onCut),q.copyPaste.onPaste(k.onPaste),s.on("keydown.handsontable."+q.guid,a)},destroy:function(a){if("function"==typeof k.editorDestroyer){var b=k.editorDestroyer;k.editorDestroyer=null,b(a)}},setCopyableText:function(){var a=Math.min(k.selStart.row(),k.selEnd.row()),b=Math.min(k.selStart.col(),k.selEnd.col()),c=Math.max(k.selStart.row(),k.selEnd.row()),d=Math.max(k.selStart.col(),k.selEnd.col()),e=Math.min(c,a+k.settings.copyRowsLimit-1),f=Math.min(d,b+k.settings.copyColsLimit-1);q.copyPaste.copyable(l.getText({row:a,col:b},{row:e,col:f})),(c!==e||d!==f)&&q.PluginHooks.run("afterCopyLimit",c-a+1,d-b+1,k.settings.copyRowsLimit,k.settings.copyColsLimit)},prepare:function(){if(!q.getCellMeta(k.selStart.row(),k.selStart.col()).readOnly){var a=q.view.getCellAtCoords(k.selStart.coords());k.editorDestroyer=q.view.applyCellTypeMethod("editor",a,k.selStart.row(),k.selStart.col())}}},this.init=function(){q.PluginHooks.run("beforeInit"),o.init(),this.updateSettings(k.settings,!0),this.parseSettingsFromDOM(),this.view=new e.TableView(this),this.forceFullRender=!0,this.view.render(),"object"==typeof k.firstRun&&(q.PluginHooks.run("afterChange",k.firstRun[0],k.firstRun[1]),k.firstRun=!1),q.PluginHooks.run("afterInit")},this.validateCell=function(a,b,c,d){var e=b.validator;"[object RegExp]"===Object.prototype.toString.call(e)&&(e=function(a){return function(b,c){c(a.test(b))}}(e)),"function"==typeof e?(a=q.PluginHooks.execute("beforeValidate",a,b.row,b.prop,d),e.call(b,a,function(e){b.valid=e,e=q.PluginHooks.execute("afterValidate",e,a,b.row,b.prop,d),c(e)})):(b.valid=!0,c(!0))},this.setDataAtCell=function(a,b,c,d){var e,f,j,k=i(a,b,c),m=[];for(e=0,f=k.length;f>e;e++){if("object"!=typeof k[e])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof k[e][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");j=l.colToProp(k[e][1]),m.push([k[e][0],j,l.get(k[e][0],j),k[e][2]])}d||"object"!=typeof a||(d=b),g(m,d,function(){h(m,d)})},this.setDataAtRowProp=function(a,b,c,d){var e,f,j=i(a,b,c),k=[];for(e=0,f=j.length;f>e;e++)k.push([j[e][0],j[e][1],l.get(j[e][0],j[e][1]),j[e][2]]);d||"object"!=typeof a||(d=b),g(k,d,function(){h(k,d)})},this.listen=function(){e.activeGuid=q.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){e.activeGuid=null},this.isListening=function(){return e.activeGuid===q.guid},this.destroyEditor=function(a){n.refreshBorders(a)},this.populateFromArray=function(a,b,c,d,e,f,g){if("object"!=typeof c)throw new Error("populateFromArray parameter `input` must be an array");return m.populateFromArray({row:a,col:b},c,"number"==typeof d?{row:d,col:e}:null,f,g)},this.spliceCol=function(){return l.spliceCol.apply(null,arguments)},this.spliceRow=function(){return l.spliceRow.apply(null,arguments)},this.getCornerCoords=function(a){return m.getCornerCoords(a)},this.getSelected=function(){return n.isSelected()?[k.selStart.row(),k.selStart.col(),k.selEnd.row(),k.selEnd.col()]:void 0},this.parseSettingsFromDOM=function(){var a=this.rootElement.css("overflow");if("scroll"===a||"auto"===a?(this.rootElement[0].style.overflow="visible",k.settingsFromDOM.overflow=a):(void 0===k.settings.width||void 0===k.settings.height)&&(k.settingsFromDOM.overflow="auto"),k.settingsFromDOM.width=void 0===k.settings.width?this.rootElement.width():void 0,k.settingsFromDOM.height=void 0,void 0===k.settings.height&&("scroll"===k.settingsFromDOM.overflow||"auto"===k.settingsFromDOM.overflow)){var b=this.rootElement[0].cloneNode(!1),c=this.rootElement[0].parentNode;if(c){b.removeAttribute("id"),c.appendChild(b);var e=parseInt(d.getComputedStyle(b,null).getPropertyValue("height"),10);isNaN(e)&&b.currentStyle&&(e=parseInt(b.currentStyle.height,10)),e>0&&(k.settingsFromDOM.height=e),c.removeChild(b)}}},this.render=function(){q.view&&(q.forceFullRender=!0,q.parseSettingsFromDOM(),n.refreshBorders(null,!0))},this.loadData=function(b){if(!b.push||!b.splice)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof b+" given)");k.isPopulated=!1,r.prototype.data=b,k.dataType=k.settings.dataSchema instanceof Array||b[0]instanceof Array?"array":a.isFunction(k.settings.dataSchema)?"function":"object",k.duckDataSchema=b[0]?l.recursiveDuckSchema(b[0]):{},l.createMap(),m.adjustRowsAndCols(),q.PluginHooks.run("afterLoadData"),k.firstRun?k.firstRun=[null,"loadData"]:(q.PluginHooks.run("afterChange",null,"loadData"),q.render()),k.isPopulated=!0,q.clearUndo()},this.getData=function(a,b,c,d){return"undefined"==typeof a?l.getAll():l.getRange({row:a,col:b},{row:c,col:d})},this.updateSettings=function(a,b){var c,d,f,g,h;if("undefined"!=typeof a.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof a.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");"undefined"!=typeof a.undo&&(k.undoRedo&&a.undo===!1?k.undoRedo=null:k.undoRedo||a.undo!==!0||(k.undoRedo=new e.UndoRedo(q)));for(c in a)"data"!==c&&(void 0!==q.PluginHooks.hooks.persistent[c]||void 0!==q.PluginHooks.legacy[c]?q.PluginHooks.add(c,a[c]):(!b&&a.hasOwnProperty(c)&&(r.prototype[c]=a[c]),e.extension[c]&&(k.extensions[c]=new e.extension[c](q,a[c]))));if(void 0===a.data&&void 0===k.settings.data){var i,o=[];for(d=0,f=k.settings.startRows;f>d;d++){for(i=[],g=0,h=k.settings.startCols;h>g;g++)i.push(null);o.push(i)}q.loadData(o)}else void 0!==a.data?q.loadData(a.data):void 0!==a.columns&&l.createMap();if(h=q.countCols(),k.cellSettings.length=0,h>0){var s,t;for(c=0;h>c;c++)k.columnSettings[c]=e.helper.columnFactory(r,k.columnsSettingConflicts),s=k.columnSettings[c].prototype,r.prototype.columns&&(t=r.prototype.columns[c],j(t),e.helper.extend(s,t))}"undefined"!=typeof a.fillHandle&&(p.handle&&a.fillHandle===!1?p.disable():p.handle||a.fillHandle===!1||p.init()),b||q.PluginHooks.run("afterUpdateSettings"),m.adjustRowsAndCols(),q.view&&(q.forceFullRender=!0,n.refreshBorders(null,!0))},this.getSettings=function(){return k.settings},this.getSettingsFromDOM=function(){return k.settingsFromDOM},this.clear=function(){n.selectAll(),n.empty()},this.isUndoAvailable=function(){return k.undoRedo&&k.undoRedo.isUndoAvailable()},this.isRedoAvailable=function(){return k.undoRedo&&k.undoRedo.isRedoAvailable()},this.undo=function(){k.undoRedo&&k.undoRedo.undo()},this.redo=function(){k.undoRedo&&k.undoRedo.redo()},this.clearUndo=function(){k.undoRedo&&k.undoRedo.clear()},this.alter=function(a,b,c,d,e){m.alter(a,b,c,d,e)},this.getCell=function(a,b){return q.view.getCellAtCoords({row:a,col:b})},this.colToProp=function(a){return l.colToProp(a)},this.propToCol=function(a){return l.propToCol(a)},this.getDataAtCell=function(a,b){return l.get(a,l.colToProp(b))},this.getDataAtRowProp=function(a,b){return l.get(a,b)},this.getDataAtCol=function(a){return[].concat.apply([],l.getRange({row:0,col:a},{row:k.settings.data.length-1,col:a}))},this.getDataAtProp=function(a){return[].concat.apply([],l.getRange({row:0,col:l.propToCol(a)},{row:k.settings.data.length-1,col:l.propToCol(a)}))},this.getDataAtRow=function(a){return k.settings.data[a]},this.getCellMeta=function(a,b){function c(a){var b={row:a};return q.PluginHooks.execute("beforeGet",b),b.row}function d(a){return e.PluginHooks.execute(q,"modifyCol",a)}var f,g=l.colToProp(b);if(a=c(a),b=d(b),"undefined"==typeof k.columnSettings[b]&&(k.columnSettings[b]=e.helper.columnFactory(r,k.columnsSettingConflicts)),k.cellSettings[a]||(k.cellSettings[a]={}),k.cellSettings[a][b]||(k.cellSettings[a][b]=new k.columnSettings[b]),f=k.cellSettings[a][b],f.row=a,f.col=b,f.prop=g,f.instance=q,q.PluginHooks.run("beforeGetCellMeta",a,b,f),j(f),f.cells){var h=f.cells.call(f,a,b,g);h&&(j(h),e.helper.extend(f,h))}return q.PluginHooks.run("afterGetCellMeta",a,b,f),f},this.validateCells=function(a){var b=new f;b.onQueueEmpty=a;for(var c=q.countRows()-1;c>=0;){for(var d=q.countCols()-1;d>=0;)b.addValidatorToQueue(),q.validateCell(q.getDataAtCell(c,d),q.getCellMeta(c,d),function(){b.removeValidatorFormQueue()},"validateCells"),d--;c--}b.checkIfQueueIsEmpty()},this.getRowHeader=function(a){if(void 0===a){for(var b=[],c=0,d=q.countRows();d>c;c++)b.push(q.getRowHeader(c));return b}return"[object Array]"===Object.prototype.toString.call(k.settings.rowHeaders)&&void 0!==k.settings.rowHeaders[a]?k.settings.rowHeaders[a]:"function"==typeof k.settings.rowHeaders?k.settings.rowHeaders(a):k.settings.rowHeaders&&"string"!=typeof k.settings.rowHeaders&&"number"!=typeof k.settings.rowHeaders?a+1:k.settings.rowHeaders},this.getColHeader=function(a){if(void 0===a){for(var b=[],c=0,d=q.countCols();d>c;c++)b.push(q.getColHeader(c));return b}return a=e.PluginHooks.execute(q,"modifyCol",a),k.settings.columns&&k.settings.columns[a]&&k.settings.columns[a].title?k.settings.columns[a].title:"[object Array]"===Object.prototype.toString.call(k.settings.colHeaders)&&void 0!==k.settings.colHeaders[a]?k.settings.colHeaders[a]:"function"==typeof k.settings.colHeaders?k.settings.colHeaders(a):k.settings.colHeaders&&"string"!=typeof k.settings.colHeaders&&"number"!=typeof k.settings.colHeaders?e.helper.spreadsheetColumnLabel(a):k.settings.colHeaders},this._getColWidthFromSettings=function(a){return k.settings.columns&&k.settings.columns[a]&&k.settings.columns[a].width?k.settings.columns[a].width:"[object Array]"===Object.prototype.toString.call(k.settings.colWidths)&&void 0!==k.settings.colWidths[a]?k.settings.colWidths[a]:void 0},this.getColWidth=function(a){a=e.PluginHooks.execute(q,"modifyCol",a);var b={width:q._getColWidthFromSettings(a)};return b.width||(b.width=50),q.PluginHooks.run("afterGetColWidth",a,b),b.width},this.countRows=function(){return k.settings.data.length},this.countCols=function(){return"object"===k.dataType||"function"===k.dataType?k.settings.columns&&k.settings.columns.length?k.settings.columns.length:k.colToProp.length:"array"===k.dataType?k.settings.columns&&k.settings.columns.length?k.settings.columns.length:k.settings.data&&k.settings.data[0]&&k.settings.data[0].length?k.settings.data[0].length:0:void 0},this.rowOffset=function(){return q.view.wt.getSetting("offsetRow")},this.colOffset=function(){return q.view.wt.getSetting("offsetColumn")},this.countVisibleRows=function(){return q.view.wt.drawn?q.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return q.view.wt.drawn?q.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(a){for(var b=q.countRows()-1,c=0;b>=0;){if(l.get(b,0),q.isEmptyRow(l.getVars.row))c++;else if(a)break;b--}return c},this.countEmptyCols=function(a){if(q.countRows()<1)return 0;for(var b=q.countCols()-1,c=0;b>=0;){if(q.isEmptyCol(b))c++;else if(a)break;b--}return c},this.isEmptyRow=function(a){if(k.settings.isEmptyRow)return k.settings.isEmptyRow.call(q,a);for(var b,c=0,d=q.countCols();d>c;c++)if(b=q.getDataAtCell(a,c),""!==b&&null!==b&&"undefined"!=typeof b)return!1;return!0},this.isEmptyCol=function(a){if(k.settings.isEmptyCol)return k.settings.isEmptyCol.call(q,a);for(var b,c=0,d=q.countRows();d>c;c++)if(b=q.getDataAtCell(c,a),""!==b&&null!==b&&"undefined"!=typeof b)return!1;return!0},this.selectCell=function(a,b,c,d,e){if("number"!=typeof a||0>a||a>=q.countRows())return!1;if("number"!=typeof b||0>b||b>=q.countCols())return!1;if("undefined"!=typeof c){if("number"!=typeof c||0>c||c>=q.countRows())return!1;if("number"!=typeof d||0>d||d>=q.countCols())return!1}return k.selStart.coords({row:a,col:b}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),q.listen(),"undefined"==typeof c?n.setRangeEnd({row:a,col:b},e):n.setRangeEnd({row:c,col:d},e),q.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=l.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=l.propToCol(arguments[3])),q.selectCell.apply(q,arguments)},this.deselectCell=function(){n.deselect()},this.destroy=function(){q.clearTimeouts(),q.view&&q.view.wt.destroy(),q.rootElement.empty(),q.rootElement.removeData("handsontable"),q.rootElement.off(".handsontable"),a(d).off("."+q.guid),s.off("."+q.guid),t.off("."+q.guid),q.copyPaste.removeCallback(k.onCut),q.copyPaste.removeCallback(k.onPaste),q.PluginHooks.run("afterDestroy")},this.getInstance=function(){return q.rootElement.data("handsontable")},function(){q.PluginHooks=new e.PluginHookClass;var a=q.PluginHooks.run,b=q.PluginHooks.execute;q.PluginHooks.run=function(b,c,d,f,g,h){a.call(this,q,b,c,d,f,g,h),e.PluginHooks.run(q,b,c,d,f,g,h)},q.PluginHooks.execute=function(a,c,d,f,g,h){var i=e.PluginHooks.execute(q,a,c,d,f,g,h),j=b.call(this,q,a,i,d,f,g,h);return"undefined"==typeof j?i:j},q.addHook=function(){q.PluginHooks.add.apply(q.PluginHooks,arguments)},q.addHookOnce=function(){q.PluginHooks.once.apply(q.PluginHooks,arguments)},q.removeHook=function(){q.PluginHooks.remove.apply(q.PluginHooks,arguments)},q.runHooks=function(){q.PluginHooks.run.apply(q.PluginHooks,arguments)},q.runHooksAndReturn=function(){return q.PluginHooks.execute.apply(q.PluginHooks,arguments)}}(),this.timeouts={},this.registerTimeout=function(a,b,c){clearTimeout(this.timeouts[a]),this.timeouts[a]=setTimeout(b,c||0)},this.clearTimeouts=function(){for(var a in this.timeouts)this.timeouts.hasOwnProperty(a)&&clearTimeout(this.timeouts[a])},this.version="0.9.12"};var K=function(){};K.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,undo:!0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:void 0,isEmptyCol:void 0,observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",fragmentSelection:!1,readOnly:!1},a.fn.handsontable=function(a){var b,c,d,f,g,h=this.first(),i=h.data("handsontable");if("string"!=typeof a)return g=a||{},i?i.updateSettings(g):(i=new e.Core(h,g),h.data("handsontable",i),i.init()),h;if(d=[],arguments.length>1)for(b=1,c=arguments.length;c>b;b++)d.push(arguments[b]);if(i){if("undefined"==typeof i[a])throw new Error("Handsontable do not provide action: "+a);f=i[a].apply(i,d)}return f},e.TableView=function(b){var c=this,f=a(d),g=a(document.documentElement);this.instance=b,this.settings=b.getSettings(),this.settingsFromDOM=b.getSettingsFromDOM(),b.rootElement.data("originalStyle",b.rootElement[0].getAttribute("style")),b.rootElement.addClass("handsontable");var h=document.createElement("TABLE");h.className="htCore",this.THEAD=document.createElement("THEAD"),h.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),h.appendChild(this.TBODY),b.$table=a(h),b.rootElement.prepend(b.$table),b.rootElement.on("mousedown.handsontable",function(a){c.isTextSelectionAllowed(a.target)||(a.preventDefault(),k())}),g.on("keyup."+b.guid,function(a){b.selection.isInProgress()&&!a.shiftKey&&b.selection.finish()});var i,j;g.on("mouseup."+b.guid,function(a){b.selection.isInProgress()&&1===a.which&&b.selection.finish(),i=!1,clearInterval(j),j=null,b.autofill.handle&&b.autofill.handle.isDragged&&(b.autofill.handle.isDragged>1&&b.autofill.apply(),b.autofill.handle.isDragged=0),e.helper.isOutsideInput(document.activeElement)&&b.unlisten()}),g.on("mousedown."+b.guid,function(d){var e=d.target;if(e!==c.wt.wtTable.spreader)for(;e!==document.documentElement;){if(null===e)return;if(e===b.rootElement[0]||"X-HANDSONTABLE"===e.nodeName||"context-menu-layer"===e.id||a(e).is(".context-menu-list")||a(e).is(".typeahead li"))return;e=e.parentNode}c.settings.outsideClickDeselects?b.deselectCell():b.destroyEditor()}),b.rootElement.on("mousedown.handsontable",".dragdealer",function(){b.destroyEditor()}),b.$table.on("selectstart",function(a){c.settings.fragmentSelection||a.preventDefault()}),b.$table.on("mouseenter",function(){j&&(clearInterval(j),j=null)}),b.$table.on("mouseleave",function(a){if(i||b.autofill.handle&&b.autofill.handle.isDragged){var d,e,f=1,g=c.wt.wtDom.offset(h),k=g.top+f,l=g.left+f,m=c.containerWidth-c.wt.getSetting("scrollbarWidth")-2*f,n=c.containerHeight-c.wt.getSetting("scrollbarHeight")-2*f,o=0,p=0;a.pageY<k?(o=-1,d="scrollVertical"):a.pageY>=k+n?(o=1,d="scrollVertical"):a.pageX<l?(p=-1,d="scrollHorizontal"):a.pageX>=l+m&&(p=1,d="scrollHorizontal"),d&&(e=function(){(i||b.autofill.handle&&b.autofill.handle.isDragged)&&c.wt[d](o+p).draw()},e(),j=setInterval(e,100))}});var k=function(){d.getSelection?d.getSelection().empty?d.getSelection().empty():d.getSelection().removeAllRanges&&d.getSelection().removeAllRanges():document.selection&&document.selection.empty()},l={table:h,stretchH:this.settings.stretchH,data:b.getDataAtCell,totalRows:b.countRows,totalColumns:b.countCols,scrollbarModelV:this.settings.scrollbarModelV,scrollbarModelH:this.settings.scrollbarModelH,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return c.settings.fixedColumnsLeft},fixedRowsTop:function(){return c.settings.fixedRowsTop},rowHeaders:function(){return c.settings.rowHeaders?[function(a,b){c.appendRowHeader(a,b)}]:[]},columnHeaders:function(){return c.settings.colHeaders?[function(a,b){c.appendColHeader(a,b)}]:[]},columnWidth:b.getColWidth,cellRenderer:function(a,b,d){c.applyCellTypeMethod("renderer",d,a,b)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return c.settings.fillHandle&&!c.isCellEdited()&&!b.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return c.settings.fillHandle&&!c.isCellEdited()&&b.selection.isMultiple()}}},highlight:{highlightRowClassName:c.settings.currentRowClassName,highlightColumnClassName:c.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return c.settings.fragmentSelection},onCellMouseDown:function(a,d,e){b.listen(),i=!0;var f={row:d[0],col:d[1]};2===a.button&&b.selection.inInSelection(f)||(a.shiftKey?b.selection.setRangeEnd(f):b.selection.setRangeStart(f)),c.settings.afterOnCellMouseDown&&c.settings.afterOnCellMouseDown.call(b,a,d,e)},onCellMouseOver:function(a,c){var d={row:c[0],col:c[1]};i?b.selection.setRangeEnd(d):b.autofill.handle&&b.autofill.handle.isDragged&&(b.autofill.handle.isDragged++,b.autofill.showBorder(c))},onCellCornerMouseDown:function(a){b.autofill.handle.isDragged=1,a.preventDefault()},onCellCornerDblClick:function(){b.autofill.selectAdjacent()},beforeDraw:function(a){c.beforeRender(a)},onDraw:function(a){c.onDraw(a)}};b.PluginHooks.run("beforeInitWalkontable",l),this.wt=new w(l),f.on("resize."+b.guid,function(){b.registerTimeout("resizeTimeout",function(){b.parseSettingsFromDOM();var a=c.getWidth(),d=c.getHeight();(l.width!==a||l.height!==d)&&(b.forceFullRender=!0,c.render(),l.width=a,l.height=d)},60)}),a(c.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(a){a.target===c.wt.wtTable.spreader&&3===a.which&&a.stopPropagation()}),g.on("click."+b.guid,function(){c.settings.observeDOMVisibility&&c.wt.drawInterrupted&&(c.instance.forceFullRender=!0,c.render())})},e.TableView.prototype.isTextSelectionAllowed=function(a){return"TEXTAREA"===a.nodeName?!0:this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(a,this.TBODY)?!0:!1},e.TableView.prototype.isCellEdited=function(){return document.activeElement!==document.body},e.TableView.prototype.getWidth=function(){var a=void 0!==this.settings.width?this.settings.width:this.settingsFromDOM.width;return"function"==typeof a?a():a},e.TableView.prototype.getHeight=function(){var a=void 0!==this.settings.height?this.settings.height:this.settingsFromDOM.height;return"function"==typeof a?a():a},e.TableView.prototype.beforeRender=function(a){a&&(this.instance.PluginHooks.run("beforeRender"),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))},e.TableView.prototype.onDraw=function(a){a&&this.instance.PluginHooks.run("afterRender")},e.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},e.TableView.prototype.applyCellTypeMethod=function(a,b,c,d){var f=this.instance.colToProp(d),g=this.instance.getCellMeta(c,d),h=e.helper.getCellMethod(a,g[a]);return h(this.instance,b,c,d,f,this.instance.getDataAtRowProp(c,f),g)},e.TableView.prototype.getCellAtCoords=function(a){var b=this.wt.wtTable.getCell([a.row,a.col]);return 0>b?null:b},e.TableView.prototype.scrollViewport=function(a){this.wt.scrollViewport([a.row,a.col])},e.TableView.prototype.appendRowHeader=function(a,b){a>-1?this.wt.wtDom.fastInnerHTML(b,this.instance.getRowHeader(a)):this.wt.wtDom.empty(b)},e.TableView.prototype.appendColHeader=function(a,b){var c=document.createElement("DIV"),d=document.createElement("SPAN");for(c.className="relative",d.className="colHeader",this.wt.wtDom.fastInnerHTML(d,this.instance.getColHeader(a)),c.appendChild(d);b.firstChild;)b.removeChild(b.firstChild);b.appendChild(c),this.instance.PluginHooks.run("afterGetColHeader",a,b)},e.TableView.prototype.maximumVisibleElementWidth=function(a){var b=this.wt.wtViewport.getWorkspaceWidth();return b-a},e.TableView.prototype.maximumVisibleElementHeight=function(a){var b=this.wt.wtViewport.getWorkspaceHeight();return b-a},e.helper.isPrintableChar=function(a){return 32==a||a>=48&&57>=a||a>=96&&111>=a||a>=186&&192>=a||a>=219&&222>=a||a>=226||a>=65&&90>=a},e.helper.stringify=function(a){switch(typeof a){case"string":case"number":return a+"";case"object":return null===a?"":a.toString();case"undefined":return"";default:return a.toString()}},e.helper.spreadsheetColumnLabel=function(a){for(var b,c=a+1,d="";c>0;)b=(c-1)%26,d=String.fromCharCode(65+b)+d,c=parseInt((c-b)/26,10);return d},e.helper.isNumeric=function(a){var b=typeof a;return"number"==b?!isNaN(a)&&isFinite(a):"string"==b?a.length?1==a.length?/\d/.test(a):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(a):!1:"object"==b?!(!a||"number"!=typeof a.valueOf()||a instanceof Date):!1},e.helper.isDescendant=function(a,b){for(var c=b.parentNode;null!=c;){if(c==a)return!0;c=c.parentNode}return!1},e.helper.randomString=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()},e.helper.inherit=function(a,b){function c(){}return c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a},e.helper.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},e.helper.columnFactory=function(a,b){var c=0,d=b.length,e=function(){};for(e.prototype=new a;d>c;c++)e.prototype[b[c]]=void 0;return e},e.helper.translateRowsToColumns=function(a){var b,c,d,e,f=[],g=0;for(b=0,c=a.length;c>b;b++)for(d=0,e=a[b].length;e>d;d++)d==g&&(f.push([]),g++),f[d].push(a[b][d]);return f},e.helper.to2dArray=function(a){for(var b=0,c=a.length;c>b;)a[b]=[a[b]],b++},e.helper.extendArray=function(a,b){for(var c=0,d=b.length;d>c;)a.push(b[c]),c++},e.helper.getCellMethod=function(a,b){if("string"==typeof b){var c=e.cellLookup[a][b];if(void 0===c)throw new Error("You declared cell "+a+' "'+b+'" as a string that is not mapped to a known function. Cell '+a+" must be a function or a string mapped to a function in Handsontable.cellLookup."+a+" lookup object");return c}return b},e.helper.isOutsideInput=function(a){var b=["INPUT","SELECT","TEXTAREA"];
return b.indexOf(a.nodeName)>-1&&-1==a.className.indexOf("handsontableInput")},e.UndoRedo=function(a){var b=this;this.instance=a,this.clear(),e.PluginHooks.add("afterChange",function(a,c){"undo"!==c&&"redo"!==c&&b.add(a,c)})},e.UndoRedo.prototype.undo=function(){var b,c;if(this.isUndoAvailable()){var d=a.extend(!0,[],this.data[this.rev]);for(b=0,c=d.length;c>b;b++)d[b].splice(3,1);this.instance.setDataAtRowProp(d,null,null,"undo"),this.rev--}},e.UndoRedo.prototype.redo=function(){var b,c;if(this.isRedoAvailable()){this.rev++;var d=a.extend(!0,[],this.data[this.rev]);for(b=0,c=d.length;c>b;b++)d[b].splice(2,1);this.instance.setDataAtRowProp(d,null,null,"redo")}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.rev>=0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.rev<this.data.length-1},e.UndoRedo.prototype.add=function(a){this.rev++,this.data.splice(this.rev),this.data.push(a)},e.UndoRedo.prototype.clear=function(){this.data=[],this.rev=-1},e.SelectionPoint=function(){this._row=null,this._col=null},e.SelectionPoint.prototype.exists=function(){return null!==this._row},e.SelectionPoint.prototype.row=function(a){return void 0!==a&&(this._row=a),this._row},e.SelectionPoint.prototype.col=function(a){return void 0!==a&&(this._col=a),this._col},e.SelectionPoint.prototype.coords=function(a){return void 0!==a&&(this._row=a.row,this._col=a.col),{row:this._row,col:this._col}},e.SelectionPoint.prototype.arr=function(a){return void 0!==a&&(this._row=a[0],this._col=a[1]),[this._row,this._col]},e.TextRenderer=function(a,b,c,d,f,g,h){var i=e.helper.stringify(g);a.view.wt.wtDom.fastInnerText(b,i),h.readOnly&&a.view.wt.wtDom.addClass(b,"htDimmed"),h.valid===!1&&h.invalidCellClassName&&a.view.wt.wtDom.addClass(b,h.invalidCellClassName)};var L=document.createElement("DIV");L.className="htAutocomplete";var M=document.createElement("DIV");M.className="htAutocompleteArrow",M.appendChild(document.createTextNode("▼")),e.AutocompleteRenderer=function(a,b,c,d,f,g,h){var i=L.cloneNode(!1),j=M.cloneNode(!0);a.acArrowListener||(a.acArrowListener=function(){a.view.wt.getSetting("onCellDblClick")},a.rootElement.on("mouseup",".htAutocompleteArrow",a.acArrowListener)),e.TextRenderer(a,i,c,d,f,g,h),i.firstChild||i.appendChild(document.createTextNode(" ")),i.appendChild(j),a.view.wt.wtDom.empty(b),b.appendChild(i)};var N=document.createElement("INPUT");N.className="htCheckboxRendererInput",N.type="checkbox",N.setAttribute("autocomplete","off"),e.CheckboxRenderer=function(b,c,d,f,g,h,i){"undefined"==typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"==typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1),b.view.wt.wtDom.empty(c);var j=N.cloneNode(!1);h===i.checkedTemplate||h===e.helper.stringify(i.checkedTemplate)?(j.checked=!0,c.appendChild(j)):h===i.uncheckedTemplate||h===e.helper.stringify(i.uncheckedTemplate)?c.appendChild(j):null===h?(j.className+=" noValue",c.appendChild(j)):b.view.wt.wtDom.fastInnerText(c,"#bad value#");var k=a(j);return i.readOnly?k.on("click",function(a){a.preventDefault()}):(k.on("mousedown",function(a){a.stopPropagation()}),k.on("mouseup",function(a){a.stopPropagation()}),k.on("change",function(){this.checked?b.setDataAtRowProp(d,g,i.checkedTemplate):b.setDataAtRowProp(d,g,i.uncheckedTemplate)})),b.CheckboxRenderer&&b.CheckboxRenderer.beforeKeyDownHookBound||(b.CheckboxRenderer={beforeKeyDownHookBound:!0},b.addHook("beforeKeyDown",function(a){if(32==a.keyCode){a.stopImmediatePropagation(),a.preventDefault();for(var c,d,e,f=b.getSelected(),g={row:Math.min(f[0],f[2]),col:Math.min(f[1],f[3])},h={row:Math.max(f[0],f[2]),col:Math.max(f[1],f[3])},i=g.row;i<=h.row;i++)for(var j=h.col;j<=h.col;j++)if(c=b.getCell(i,j),e=b.getCellMeta(i,j),d=c.querySelectorAll("input[type=checkbox]"),d.length>0&&!e.readOnly)for(var k=0,l=d.length;l>k;k++)d[k].checked=!d[k].checked}})),c},e.NumericRenderer=function(a,b,c,d,f,g,h){e.helper.isNumeric(g)&&("undefined"!=typeof h.language&&numeral.language(h.language),g=numeral(g).format(h.format||"0"),a.view.wt.wtDom.addClass(b,"htNumeric")),e.TextRenderer(a,b,c,d,f,g,h)},f.prototype.createElements=function(){this.STATE_VIRGIN="STATE_VIRGIN",this.STATE_EDITING="STATE_EDITING",this.STATE_WAITING="STATE_WAITING",this.STATE_FINISHED="STATE_FINISHED",this.state=this.STATE_VIRGIN,this.waitingEvent=null,this.wtDom=new x,this.TEXTAREA=document.createElement("TEXTAREA"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=a(this.TEXTAREA),this.TEXTAREA_PARENT=document.createElement("DIV"),this.TEXTAREA_PARENT.className="handsontableInputHolder",this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.$body=a(document.body),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var b=this;e.PluginHooks.add("afterRender",function(){b.instance.registerTimeout("refresh_editor_dimensions",function(){b.refreshDimensions()},0)})},f.prototype.bindEvents=function(){var a=this;this.$textarea.off(".editor").on("keydown.editor",function(b){if(a.state===a.STATE_WAITING?b.stopImmediatePropagation():a.waitingEvent=null,a.state===a.STATE_EDITING){var c=(b.ctrlKey||b.metaKey)&&!b.altKey;if(17===b.keyCode||224===b.keyCode||91===b.keyCode||93===b.keyCode)return b.stopImmediatePropagation(),void 0;switch(b.keyCode){case 38:a.finishEditing(!1);break;case 40:a.finishEditing(!1);break;case 9:a.finishEditing(!1),b.preventDefault();break;case 39:a.getCaretPosition(a.TEXTAREA)===a.TEXTAREA.value.length?a.finishEditing(!1):b.stopImmediatePropagation();break;case 37:0===a.getCaretPosition(a.TEXTAREA)?a.finishEditing(!1):b.stopImmediatePropagation();break;case 27:a.instance.destroyEditor(!0),b.stopImmediatePropagation();break;case 13:var d=a.instance.getSelected(),e=!(d[0]===d[2]&&d[1]===d[3]);b.ctrlKey&&!e||b.altKey?(a.TEXTAREA.value=a.TEXTAREA.value+"\n",a.TEXTAREA.focus(),b.stopImmediatePropagation()):a.finishEditing(!1,c),b.preventDefault();break;default:b.stopImmediatePropagation()}a.state===a.STATE_FINISHED||b.isImmediatePropagationStopped()||(a.waitingEvent=b,b.stopImmediatePropagation(),b.preventDefault())}})},f.prototype.bindTemporaryEvents=function(a,b,c,d,f,g){function h(){i.TEXTAREA.value=i.originalValue,i.instance.destroyEditor(),i.beginEditing(b,c,d,!0)}var i=this;this.state=this.STATE_VIRGIN,this.instance.view.wt.update("onCellDblClick",h),this.TD=a,this.row=b,this.col=c,this.prop=d,this.originalValue=f,this.cellProperties=g,this.beforeKeyDownHook=function(a){if(i.state===i.STATE_VIRGIN){var f=(a.ctrlKey||a.metaKey)&&!a.altKey;if(e.helper.isPrintableChar(a.keyCode))f||(i.beginEditing(b,c,d),a.stopImmediatePropagation());else if(113===a.keyCode)i.beginEditing(b,c,d,!0),a.stopImmediatePropagation(),a.preventDefault();else if(13===a.keyCode&&i.instance.getSettings().enterBeginsEditing){var g=i.instance.getSelected(),h=!(g[0]===g[2]&&g[1]===g[3]);f&&!h||a.altKey?i.beginEditing(b,c,d,!0,"\n"):i.beginEditing(b,c,d,!0),a.preventDefault(),a.stopImmediatePropagation()}}},i.instance.addHookOnce("beforeKeyDown",this.beforeKeyDownHook)},f.prototype.unbindTemporaryEvents=function(){this.instance.removeHook("beforeKeyDown",this.beforeKeyDownHook),this.instance.view.wt.update("onCellDblClick",null)},f.prototype.getCaretPosition=function(a){if(a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();if(null==b)return 0;var c=a.createTextRange(),d=c.duplicate();return c.moveToBookmark(b.getBookmark()),d.setEndPoint("EndToStart",c),d.text.length}return 0},f.prototype.setCaretPosition=function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},f.prototype.beginEditing=function(a,b,c,d,f){if(this.state===this.STATE_VIRGIN){this.state=this.STATE_EDITING,this.row=a,this.col=b,this.prop=c,this.$textarea.on("cut.editor",function(a){a.stopPropagation()}),this.$textarea.on("paste.editor",function(a){a.stopPropagation()}),this.TEXTAREA.value=d?e.helper.stringify(this.originalValue)+(f||""):"",this.refreshDimensions(),this.TEXTAREA.focus(),this.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length);var g={row:a,col:b};this.instance.view.scrollViewport(g),this.instance.view.render()}},f.prototype.refreshDimensions=function(){if(this.state===this.STATE_EDITING){this.TD=this.instance.getCell(this.row,this.col);var b=a(this.TD),c=this.wtDom.offset(this.TD),d=this.wtDom.offset(this.instance.rootElement[0]),e=this.instance.rootElement.scrollTop(),f=this.instance.rootElement.scrollLeft(),g=c.top-d.top+e-1,h=c.left-d.left+f-1,i=this.instance.getSettings(),j=i.rowHeaders===!1?0:1,k=i.colHeaders===!1?0:1;0>g&&(g=0),0>h&&(h=0),j>0&&parseInt(b.css("border-top-width"),10)>0&&(g+=1),k>0&&parseInt(b.css("border-left-width"),10)>0&&(h+=1),a.browser.msie&&parseInt(a.browser.version,10)<=7&&(g-=1),this.textareaParentStyle.top=g+"px",this.textareaParentStyle.left=h+"px";var l=b.width(),m=this.instance.view.maximumVisibleElementWidth(h)-10,n=b.outerHeight()-4,o=this.instance.view.maximumVisibleElementHeight(g)-5;parseInt(b.css("border-top-width"),10)>0&&(n-=1),parseInt(b.css("border-left-width"),10)>0&&j>0&&(l-=1),this.$textarea.autoResize({minHeight:Math.min(n,o),maxHeight:o,minWidth:Math.min(l,m),maxWidth:m,animate:!1,extraSpace:0}),this.textareaParentStyle.display="block"}},f.prototype.saveValue=function(a,b){if(b){var c=this.instance.getSelected();this.instance.populateFromArray(c[0],c[1],a,c[2],c[3],"edit")}else this.instance.populateFromArray(this.row,this.col,a,null,null,"edit")},f.prototype.finishEditing=function(b,c){var d=!1;if(this.state!=this.STATE_WAITING&&this.state!=this.STATE_FINISHED){if(this.state==this.STATE_EDITING){var e;if(e=b?[[this.originalValue]]:[[a.trim(this.TEXTAREA.value)]],d=this.instance.getCellMeta(this.row,this.col).validator){this.state=this.STATE_WAITING;var f=this;this.instance.addHookOnce("afterValidate",function(a){f.state=f.STATE_FINISHED,f.discardEditor(a)})}this.saveValue(e,c)}d||(this.state=this.STATE_FINISHED,this.discardEditor())}},f.prototype.discardEditor=function(b){if(this.state===this.STATE_FINISHED)if(b===!1&&this.cellProperties.allowInvalid!==!0)this.state=this.STATE_EDITING,this.instance.view.wt.wtDom.isVisible(this.TEXTAREA)&&(this.TEXTAREA.focus(),this.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length));else if(this.state=this.STATE_FINISHED,document.activeElement===this.TEXTAREA&&this.instance.listen(),this.unbindTemporaryEvents(),this.textareaParentStyle.display="none",this.waitingEvent){var c=a.Event(this.waitingEvent.type);c.keyCode=this.waitingEvent.keyCode,this.waitingEvent=null,a(document.activeElement).trigger(c)}},e.TextEditor=function(a,b,c,d,e,g,h){return a.textEditor||(a.textEditor=new f(a)),(a.textEditor.state===a.textEditor.STATE_VIRGIN||a.textEditor.state===a.textEditor.STATE_FINISHED)&&a.textEditor.bindTemporaryEvents(b,c,d,e,g,h),function(b){a.textEditor.finishEditing(b)}},e.helper.inherit(g,f),g.prototype.createElements=function(){f.prototype.createElements.call(this),this.$textarea.typeahead(),this.typeahead=this.$textarea.data("typeahead"),this.typeahead._render=this.typeahead.render,this.typeahead.minLength=0,this.typeahead.lookup=function(){var b;return this.query=this.$element.val(),b=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,b?this.process(b):this},this.typeahead.matcher=function(){return!0};var b=this.typeahead.process,c=this;this.typeahead.process=function(d){for(var e=!1,f=0,g=d.length;g>f;f++)""===d[f]&&(e||(d=a.extend([],d),e=!0),d[f]=c.emptyStringLabel);return b.call(this,d)}},g.prototype.bindEvents=function(){var a=this;this.$textarea.off("keydown").off("keyup").off("keypress"),this.$textarea.off(".acEditor").on("keydown.acEditor",function(b){switch(b.keyCode){case 38:a.typeahead.prev(),b.stopImmediatePropagation();break;case 40:a.typeahead.next(),b.stopImmediatePropagation();break;case 13:b.preventDefault()}}),this.$textarea.on("keyup.acEditor",function(b){(e.helper.isPrintableChar(b.keyCode)||113===b.keyCode||13===b.keyCode||8===b.keyCode||46===b.keyCode)&&a.typeahead.lookup()}),f.prototype.bindEvents.call(this)},g.prototype.bindTemporaryEvents=function(a,b,c,d,e,g){function h(){k.beginEditing(b,c,d,!0),k.instance.registerTimeout("IE9_align_fix",function(){k.typeahead.lookup()},1)}var i,j,k=this;this.typeahead.select=function(){var a=this.hide();k.instance.destroyEditor(!0);var e=this.$menu[0].querySelector(".active"),f=e.getAttribute("data-value");return f===k.emptyStringLabel&&(f=""),"function"==typeof g.onSelect?g.onSelect(b,c,d,f,k.instance.view.wt.wtDom.index(e)):k.instance.setDataAtRowProp(b,d,f),a},this.typeahead.render=function(a){if(k.typeahead._render.call(this,a),!g.strict){var b=this.$menu[0].querySelector(".active");b&&k.instance.view.wt.wtDom.removeClass(b,"active")}return this};for(i in g)if("options"===i)for(j in g.options)this.typeahead.options[j]=g.options[j];else this.typeahead[i]=g[i];f.prototype.bindTemporaryEvents.call(this,a,b,c,d,e,g),this.instance.view.wt.update("onCellDblClick",h)},g.prototype.finishEditing=function(a,b){a||(this.isMenuExpanded()&&this.typeahead.$menu[0].querySelector(".active")?(this.typeahead.select(),this.state=this.STATE_FINISHED):this.cellProperties.strict&&(this.state=this.STATE_FINISHED)),f.prototype.finishEditing.call(this,a,b)},g.prototype.isMenuExpanded=function(){return this.instance.view.wt.wtDom.isVisible(this.typeahead.$menu[0])?this.typeahead:!1},e.AutocompleteEditor=function(a,b,c,d,e,f,h){return a.autocompleteEditor||(a.autocompleteEditor=new g(a)),a.autocompleteEditor.bindTemporaryEvents(b,c,d,e,f,h),function(b){a.autocompleteEditor.finishEditing(b)}},e.CheckboxEditor=function(a,b,c,d,f,g,i){return"undefined"==typeof i&&(i={}),"undefined"==typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"==typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1),a.$table.on("keydown.editor",function(b){var d=(b.ctrlKey||b.metaKey)&&!b.altKey;!d&&e.helper.isPrintableChar(b.keyCode)&&(h(a,c,f,i),b.stopImmediatePropagation(),b.preventDefault())}),a.view.wt.update("onCellDblClick",function(){h(a,c,f,i)}),function(){a.$table.off(".editor"),a.view.wt.update("onCellDblClick",null)}},e.helper.inherit(i,f),i.prototype.createElements=function(){f.prototype.createElements.call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,this.instance.rootElement[0].appendChild(this.datePicker),this.$datePicker=a(this.datePicker);var b=this,c={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,altField:this.$textarea,onSelect:function(){b.finishEditing(!1)}};this.$datePicker.datepicker(c),this.hideDatepicker()},i.prototype.beginEditing=function(a,b,c,d,e){f.prototype.beginEditing.call(this,a,b,c,d,e),this.showDatepicker()},i.prototype.finishEditing=function(a,b){this.hideDatepicker(),f.prototype.finishEditing.call(this,a,b)},i.prototype.showDatepicker=function(){var b=a(this.instance.dateEditor.TD),c=b.position();this.datePickerStyle.top=c.top+b.height()+"px",this.datePickerStyle.left=c.left+"px";var d={defaultDate:this.originalValue||void 0};a.extend(d,this.cellProperties),this.$datePicker.datepicker("option",d),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},i.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},e.DateEditor=function(a,b,c,d,e,f,g){return a.dateEditor||(a.dateEditor=new i(a)),a.dateEditor.bindTemporaryEvents(b,c,d,e,f,g),function(b){a.dateEditor.finishEditing(b)}},e.helper.inherit(j,f),j.prototype.createElements=function(){f.prototype.createElements.call(this);var b=document.createElement("DIV");b.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(b),this.$htContainer=a(b)},j.prototype.bindTemporaryEvents=function(b,c,d,e,g,h){var i=this,j={colHeaders:!0,cells:function(){return{readOnly:!0}},fillHandle:!1,width:2e3,afterOnCellMouseDown:function(){var a=this.getSelected();i.TEXTAREA.value=this.getDataAtCell(a[0],a[1]),i.instance.destroyEditor()},beforeOnKeyDown:function(a){switch(a.keyCode){case 27:i.instance.destroyEditor(!0);break;case 13:var b=this.getSelected();i.TEXTAREA.value=this.getDataAtCell(b[0],b[1]),i.instance.destroyEditor()}}};h.handsontable&&(j=a.extend(j,h.handsontable)),this.$htContainer.handsontable(j),f.prototype.bindTemporaryEvents.call(this,b,c,d,e,g,h)},j.prototype.beginEditing=function(a,b,c,d,e){var g=this.instance.getSettings().onBeginEditing;g&&g()===!1||(f.prototype.beginEditing.call(this,a,b,c,d,e),this.$htContainer.handsontable("render"),this.$htContainer.handsontable("selectCell",0,0))},j.prototype.finishEditing=function(a,b){this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("destroy"),f.prototype.finishEditing.call(this,a,b)},e.HandsontableEditor=function(a,b,c,d,e,f,g){return a.handsontableEditor||(a.handsontableEditor=new j(a)),a.handsontableEditor.bindTemporaryEvents(b,c,d,e,f,g),a.registerEditor=a.handsontableEditor,function(b){a.handsontableEditor.finishEditing(b)}},e.NumericValidator=function(a,b){b(/^-?\d*\.?\d*$/.test(a))};var O=function(a,b){var c=a,d="string"==typeof c?c.toLowerCase():null;return function(a){for(var e=!1,f=0,g=a.length;g>f;f++){if(c===a[f]){e=!0;break}if(d===a[f].toLowerCase()){e=!0;break}}b(e)}};e.AutocompleteValidator=function(b,c){this.strict&&this.source?a.isFunction(this.source)?this.source(b,O(b,c)):O(b,c)(this.source):c(!0)},e.AutocompleteCell={editor:e.AutocompleteEditor,renderer:e.AutocompleteRenderer,validator:e.AutocompleteValidator},e.CheckboxCell={editor:e.CheckboxEditor,renderer:e.CheckboxRenderer},e.TextCell={editor:e.TextEditor,renderer:e.TextRenderer},e.NumericCell={editor:e.TextEditor,renderer:e.NumericRenderer,validator:e.NumericValidator,dataType:"number"},e.DateCell={editor:e.DateEditor,renderer:e.AutocompleteRenderer},e.HandsontableCell={editor:e.HandsontableEditor,renderer:e.AutocompleteRenderer},e.cellTypes={text:e.TextCell,date:e.DateCell,numeric:e.NumericCell,checkbox:e.CheckboxCell,autocomplete:e.AutocompleteCell,handsontable:e.HandsontableCell},e.cellLookup={renderer:{text:e.TextRenderer,numeric:e.NumericRenderer,checkbox:e.CheckboxRenderer,autocomplete:e.AutocompleteRenderer},editor:{text:e.TextEditor,date:e.DateEditor,checkbox:e.CheckboxEditor,autocomplete:e.AutocompleteEditor,handsontable:e.HandsontableEditor},validator:{numeric:e.NumericValidator,autocomplete:e.AutocompleteValidator}},e.PluginHookClass=function(){function a(){this.hooks={once:b(),persistent:b()},this.legacy=c}var b=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],modifyCol:[]}},c={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"},d=function(a){return function(b,d){if(b in c&&(b=c[b]),"undefined"==typeof this.hooks[a][b]&&(this.hooks[a][b]=[]),d instanceof Array)for(var e=0,f=d.length;f>e;e++)this.hooks[a][b].push(d[e]);else this.hooks[a][b].push(d);return this}};return a.prototype.add=d("persistent"),a.prototype.once=d("once"),a.prototype.remove=function(a,b){var d,e,f,g,h,i=!1,j=["persistent","once"];a in c&&(a=c[a]);for(e=0,f=j.length;f>e;e++)if(d=j[e],"undefined"!=typeof this.hooks[d][a])for(g=0,h=this.hooks[d][a].length;h>g;g++)if(this.hooks[d][a][g]==b){this.hooks[d][a].splice(g,1),i=!0;break}return i},a.prototype.run=function(a,b,d,e,f,g,h){var i,j,k,l,m,n=["persistent","once"];b in c&&(b=c[b]);for(j=0,k=n.length;k>j;j++)if(i=n[j],"undefined"!=typeof this.hooks[i][b])for(l=0,m=this.hooks[i][b].length;m>l;l++)this.hooks[i][b][l].call(a,d,e,f,g,h),"once"===i&&(this.hooks[i][b].splice(l,1),m--,l--)},a.prototype.execute=function(a,b,d,e,f,g,h){var i,j,k,l,m,n,o=["persistent","once"];b in c&&(b=c[b]);for(j=0,k=o.length;k>j;j++)if(i=o[j],"undefined"!=typeof this.hooks[i][b])for(l=0,m=this.hooks[i][b].length;m>l;l++)n=this.hooks[i][b][l].call(a,d,e,f,g,h),void 0!==n&&(d=n),"once"===i&&(this.hooks[i][b].splice(l,1),m--,l--);return d},a}(),e.PluginHooks=new e.PluginHookClass,function(a){function b(){function b(a){var b=document,c=this;c.thead=b.createElement("table"),c.thead.appendChild(b.createElement("thead")).appendChild(b.createElement("tr")).appendChild(b.createElement("th")),c.theadTh=c.thead.getElementsByTagName("th")[0],c.theadStyle=c.thead.style,c.theadStyle.tableLayout="auto",c.theadStyle.width="auto",c.tbody=c.thead.cloneNode(!1),c.tbody.appendChild(b.createElement("tbody")).appendChild(b.createElement("tr")).appendChild(b.createElement("td")),c.tbodyTd=c.tbody.getElementsByTagName("td")[0],c.noRenderer=c.tbody.cloneNode(!0),c.noRendererTd=c.noRenderer.getElementsByTagName("td")[0],c.renderer=c.tbody.cloneNode(!0),c.rendererTd=c.renderer.getElementsByTagName("td")[0],c.container=b.createElement("div"),c.container.className=a.rootElement[0].className+" hidden",c.containerStyle=c.container.style,c.container.appendChild(c.thead),c.container.appendChild(c.tbody),c.container.appendChild(c.noRenderer),c.container.appendChild(c.renderer)}var d=this,e=5;this.beforeInit=function(){var a=this;a.autoColumnWidths=[],a.getSettings().autoColumnSize!==!1?(a.autoColumnSizeTmp||(a.autoColumnSizeTmp={thead:null,theadTh:null,theadStyle:null,tbody:null,tbodyTd:null,noRenderer:null,noRendererTd:null,renderer:null,rendererTd:null,container:null,containerStyle:null}),a.addHook("beforeRender",c.determineColumnsWidth),a.addHook("afterGetColWidth",c.getColWidth),a.addHook("afterDestroy",c.afterDestroy)):(a.removeHook("beforeRender",c.determineColumnsWidth),a.removeHook("afterGetColWidth",c.getColWidth),a.removeHook("afterDestroy",c.afterDestroy),d.afterDestroy.call(a))},this.determineColumnWidth=function(c){var d=this,f=d.autoColumnSizeTmp;f.container||(b.call(f,d),d.rootElement[0].parentNode.appendChild(f.container)),f.container.className=d.rootElement[0].className+" hidden";var g=d.$table[0].className;f.thead.className=g,f.tbody.className=g;for(var h=d.countRows(),i={},j=0,k=0;h>k;k++){var l=a.helper.stringify(d.getDataAtCell(k,c)),m=l.length;m>j&&(j=m),i[m]||(i[m]={needed:e,strings:[]}),i[m].needed&&(i[m].strings.push(l),i[m].needed--)}var n=d.getSettings();n.colHeaders&&d.view.appendColHeader(c,f.theadTh);var o="";for(var p in i)if(i.hasOwnProperty(p))for(var q=0,r=i[p].strings.length;r>q;q++)o+=i[p].strings[q]+"<br>";f.tbodyTd.innerHTML=o,d.view.wt.wtDom.empty(f.rendererTd),d.view.wt.wtDom.empty(f.noRendererTd),f.containerStyle.display="block";var s=d.view.wt.wtDom.outerWidth(f.container),t=d.getCellMeta(0,c);if(t.renderer){var u=d.getDataAtCell(0,c);f.noRendererTd.appendChild(document.createTextNode(u));var v=a.helper.getCellMethod("renderer",t.renderer);v(d,f.rendererTd,0,c,d.colToProp(c),u,t),s+=d.view.wt.wtDom.outerWidth(f.renderer)-d.view.wt.wtDom.outerWidth(f.noRenderer)}var w=d.view.wt.wtViewport.getViewportWidth()-2;return s>w&&(s=w),f.containerStyle.display="none",s},this.determineColumnsWidth=function(){var a=this,b=this.getSettings();if(b.autoColumnSize||!b.colWidths)for(var c=this.countCols(),e=0;c>e;e++)a._getColWidthFromSettings(e)||(this.autoColumnWidths[e]=d.determineColumnWidth.call(a,e))},this.getColWidth=function(a,b){this.autoColumnWidths[a]&&this.autoColumnWidths[a]>b.width&&(b.width=this.autoColumnWidths[a])},this.afterDestroy=function(){var a=this;a.autoColumnSizeTmp&&a.autoColumnSizeTmp.container&&a.autoColumnSizeTmp.container.parentNode&&a.autoColumnSizeTmp.container.parentNode.removeChild(a.autoColumnSizeTmp.container)}}var c=new b;a.PluginHooks.add("beforeInit",c.beforeInit),a.PluginHooks.add("afterUpdateSettings",c.beforeInit)}(e);var P=new k;e.PluginHooks.add("afterInit",function(){P.init.call(this,"afterInit")}),e.PluginHooks.add("afterUpdateSettings",function(){P.init.call(this,"afterUpdateSettings")}),e.PluginHooks.add("beforeGet",P.onBeforeGetSet),e.PluginHooks.add("beforeSet",P.onBeforeGetSet),e.PluginHooks.add("afterGetColHeader",P.getColHeader),function(b){function c(){var a=this,b=!!a.getSettings().contextMenu;b?d.call(a):e.call(a)}function d(){function b(a){var b=f.getSelected();if(b)switch(a){case"row_above":f.alter("insert_row",b[0]);break;case"row_below":f.alter("insert_row",b[2]+1);break;case"col_left":f.alter("insert_col",b[1]);break;case"col_right":f.alter("insert_col",b[3]+1);break;case"remove_row":f.alter(a,b[0],b[2]-b[0]+1);break;case"remove_col":f.alter(a,b[1],b[3]-b[1]+1);break;case"undo":f.undo();break;case"redo":f.redo()}}function c(a){return f.countRows()>=f.getSettings().maxRows&&("row_above"===a||"row_below"===a)?!0:f.countCols()>=f.getSettings().maxCols&&("col_left"===a||"col_right"===a)?!0:!1}var d,e,f=this,g=f.rootElement[0].id,h={row_above:{name:"Insert row above",disabled:c},row_below:{name:"Insert row below",disabled:c},hsep1:"---------",col_left:{name:"Insert column on the left",disabled:c},col_right:{name:"Insert column on the right",disabled:c},hsep2:"---------",remove_row:{name:"Remove row",disabled:c},remove_col:{name:"Remove column",disabled:c},hsep3:"---------",undo:{name:"Undo",disabled:function(){return!f.isUndoAvailable()}},redo:{name:"Redo",disabled:function(){return!f.isRedoAvailable()}}},i={selector:"#"+g+" table, #"+g+" div",trigger:"right",callback:b},j={},k=f.getSettings();if(k.contextMenu===!0)j.items=h;else if("[object Array]"===Object.prototype.toString.apply(k.contextMenu))for(j.items={},d=0,e=k.contextMenu.length;e>d;d++){var l=k.contextMenu[d];if("undefined"==typeof h[l])throw new Error('Context menu key "'+l+'" is not recognised');j.items[l]=h[l]}else if("[object Object]"===Object.prototype.toString.apply(k.contextMenu)){if(j=k.contextMenu,j.items)for(d in j.items)j.items.hasOwnProperty(d)&&h[d]&&(j.items[d]="string"==typeof j.items[d]?h[d]:a.extend(!0,h[d],j.items[d]));else j.items=h;if(j.callback){var m=i.callback,n=j.callback;j.callback=function(a,b){m(a,b),n(a,b)}}}if(!g)throw new Error("Handsontable container must have an id");a.contextMenu(a.extend(!0,i,j))}function e(){var b=this.rootElement[0].id;a.contextMenu("destroy","#"+b+" table, #"+b+" div")}b.PluginHooks.add("afterInit",c),b.PluginHooks.add("afterUpdateSettings",c),b.PluginHooks.add("afterDestroy",e)}(e),e.PluginHooks.add("beforeGetCellMeta",function(a,b,c){var d,f,g,h=this.getSettings(),i=this.getData();if(c.isWritable=!c.readOnly,h.autoComplete)for(d=0,f=h.autoComplete.length;f>d;d++)if(h.autoComplete[d].match(a,b,i)){"undefined"==typeof c.type?c.type=e.AutocompleteCell:("undefined"==typeof c.type.renderer&&(c.type.renderer=e.AutocompleteCell.renderer),"undefined"==typeof c.type.editor&&(c.type.editor=e.AutocompleteCell.editor));for(g in h.autoComplete[d])h.autoComplete[d].hasOwnProperty(g)&&"match"!==g&&"undefined"==typeof c[d]&&(c[g]="source"===g?h.autoComplete[d][g](a,b):h.autoComplete[d][g]);break}});var Q=new l;e.PluginHooks.add("beforeInit",Q.beforeInit),e.PluginHooks.add("afterInit",function(){Q.init.call(this,"afterInit")}),e.PluginHooks.add("afterUpdateSettings",function(){Q.init.call(this,"afterUpdateSettings")}),e.PluginHooks.add("afterGetColHeader",Q.getColHeader),e.PluginHooks.add("modifyCol",Q.modifyCol);var R=new m;e.PluginHooks.add("beforeInit",R.beforeInit),e.PluginHooks.add("afterInit",function(){R.init.call(this,"afterInit")}),e.PluginHooks.add("afterUpdateSettings",function(){R.init.call(this,"afterUpdateSettings")}),e.PluginHooks.add("afterGetColWidth",R.getColWidth);var S=new n;e.PluginHooks.add("afterLoadData",S.init),e.PluginHooks.add("afterUpdateSettings",S.init),function(a){function b(){function b(){var a=this;for(var b in f)f.hasOwnProperty(b)&&!d.call(a,b)&&a.PluginHooks.add(b,f[b])}function c(){var a=this;for(var b in f)f.hasOwnProperty(b)&&d.call(a,b)&&a.PluginHooks.remove(b,f[b])}function d(a){var b=this;return b.PluginHooks.hooks.persistent.hasOwnProperty(a)}var e=this;this.init=function(){var d=this,f=d.getSettings().persistentState;return e.enabled=!!f,e.enabled?(d.storage||(d.storage=new a(d.rootElement[0].id)),d.resetState=e.resetValue,b.call(d),void 0):(c.call(d),void 0)},this.saveValue=function(a,b){var c=this;c.storage.saveValue(a,b)},this.loadValue=function(a,b){var c=this;b.value=c.storage.loadValue(a)},this.resetValue=function(a){var b=this;"undefined"!=typeof a?b.storage.reset(a):b.storage.resetAll()};var f={persistentStateSave:e.saveValue,persistentStateLoad:e.loadValue,persistentStateReset:e.resetValue}}var c=new b;e.PluginHooks.add("beforeInit",c.init),e.PluginHooks.add("afterUpdateSettings",c.init)}(o),function(a){function b(d){return this.filter(b.resizableFilterSelector).each(function(){new c(a(this),d)}),this}function c(c,d){this.clones||(this.config=a.extend({},b.defaults,d),this.el=c,this.nodeName=c[0].nodeName.toLowerCase(),this.previousScrollTop=null,"original"===d.maxWidth&&(d.maxWidth=c.width()),"original"===d.minWidth&&(d.minWidth=c.width()),"original"===d.maxHeight&&(d.maxHeight=c.height()),"original"===d.minHeight&&(d.minHeight=c.height()),"textarea"===this.nodeName&&c.css({resize:"none",overflowY:"none"}),c.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())}b.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500},b.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"],b.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"},b.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]",b.AutoResizer=c,a.fn.autoResize=b,c.prototype={bind:function(){var b=a.proxy(function(){return this.check(),!0},this);this.unbind(),this.el.bind("keyup.autoResize",b).bind("change.autoResize",b),this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var c=this.el,d=this,e=this.config;this.clones=a(),("original"!==e.minHeight||"original"!==e.maxHeight)&&(this.hClone=c.clone().height("auto"),this.clones=this.clones.add(this.hClone)),("original"!==e.minWidth||"original"!==e.maxWidth)&&(this.wClone=a("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"}),this.clones=this.clones.add(this.wClone)),a.each(b.cloneCSSProperties,function(a,b){d.clones.css(b,c.css(b))}),this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(b.cloneCSSValues).css("overflowY","scroll")},check:function(a,b){var c=this.config,d=this.wClone,e=this.hClone,f=this.el,g=f.val();if(d){d.text(g);var h=d.outerWidth(),i=h+c.extraSpace>=c.minWidth?h+c.extraSpace:c.minWidth,j=f.width();i=Math.min(i,c.maxWidth),(j>i&&i>=c.minWidth||i>=c.minWidth&&i<=c.maxWidth)&&(c.onResize.call(f),f.scrollLeft(0),c.animate&&!b?f.stop(1,1).animate({width:i},c.animate):f.width(i))}if(e){i&&e.width(i),e.height(0).val(g).scrollTop(1e4);
var k=e[0].scrollTop+c.extraSpace;if(this.previousScrollTop===k)return;this.previousScrollTop=k,k>=c.maxHeight&&(k=c.maxHeight),k<c.minHeight&&(k=c.minHeight),k==c.maxHeight&&i==c.maxWidth?f.css("overflowY","scroll"):f.css("overflowY","hidden"),c.onResize.call(f),c.animate&&!b?f.stop(1,1).animate({height:k},c.animate):f.height(k)}},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clones.remove(),delete this.el,delete this.hClone,delete this.wClone,delete this.clones},injectClone:function(){(b.cloneContainer||(b.cloneContainer=a("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(jQuery),function(a){function b(a){return a.split('"').length-1}a.SheetClip={parse:function(a){var c,d,e,f,g,h,i,j=[],k=0;for(e=a.split("\n"),e.length>1&&""===e[e.length-1]&&e.pop(),c=0,d=e.length;d>c;c+=1){for(e[c]=e[c].split("	"),f=0,g=e[c].length;g>f;f+=1)j[k]||(j[k]=[]),h&&0===f?(i=j[k].length-1,j[k][i]=j[k][i]+"\n"+e[c][0],h&&1&b(e[c][0])&&(h=!1,j[k][i]=j[k][i].substring(0,j[k][i].length-1).replace(/""/g,'"'))):f===g-1&&0===e[c][f].indexOf('"')?(j[k].push(e[c][f].substring(1).replace(/""/g,'"')),h=!0):(j[k].push(e[c][f].replace(/""/g,'"')),h=!1);h||(k+=1)}return j},stringify:function(a){var b,c,d,e,f,g="";for(b=0,c=a.length;c>b;b+=1){for(d=0,e=a[b].length;e>d;d+=1)d>0&&(g+="	"),f=a[b][d],g+="string"==typeof f?f.indexOf("\n")>-1?'"'+f.replace(/"/g,'""')+'"':f:null===f||void 0===f?"":f;g+="\n"}return g}}}(d);var T=function(){var a;return{getInstance:function(){return a||(a=new p),a}}}();p.prototype.selectNodeText=function(a){a.select()},p.prototype.getSelectionText=function(){var a="";return d.getSelection?a=d.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a},p.prototype.copyable=function(a){if("string"!=typeof a&&void 0===a.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=a},p.prototype.onCut=function(a){this.cutCallbacks.push(a)},p.prototype.onPaste=function(a){this.pasteCallbacks.push(a)},p.prototype.removeCallback=function(a){var b,c;for(b=0,c=this.copyCallbacks.length;c>b;b++)if(this.copyCallbacks[b]===a)return this.copyCallbacks.splice(b,1),!0;for(b=0,c=this.cutCallbacks.length;c>b;b++)if(this.cutCallbacks[b]===a)return this.cutCallbacks.splice(b,1),!0;for(b=0,c=this.pasteCallbacks.length;c>b;b++)if(this.pasteCallbacks[b]===a)return this.pasteCallbacks.splice(b,1),!0;return!1},p.prototype.triggerCut=function(a){var b=this;b.cutCallbacks&&setTimeout(function(){for(var c=0,d=b.cutCallbacks.length;d>c;c++)b.cutCallbacks[c](a)},50)},p.prototype.triggerPaste=function(a,b){var c=this;c.pasteCallbacks&&setTimeout(function(){for(var d=(b||c.elTextarea.value).replace(/\n$/,""),e=0,f=c.pasteCallbacks.length;f>e;e++)c.pasteCallbacks[e](d,a)},50)},p.prototype._bindEvent=function(){return d.jQuery?function(b,c,d){a(b).on(c+".copypaste",d)}:function(a,b,c){a.addEventListener(b,c,!1)}}();var U;!function(a){function b(a,c){for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];e instanceof Object&&(Object.unobserve(e,a),e.____Path=c.____Path+"/"+d,b(a,e))}}function c(a,b){delete b.____Path,Object.observe(b,a);for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];e instanceof Object&&c(a,e)}}function e(a,c){Object.observe?(Object.unobserve(a,c),b(c,a)):(clearTimeout(c.next),c.unbindWindowEvents())}function f(a,e){var f=[],h=a;if(Object.observe)var i=function(a){if(!h.___Path){Object.unobserve(h,i),h.____Path="",b(i,h);for(var d=0,g=a.length;g>d;)"____Path"!=a[d].name&&q[a[d].type].call(a[d],f,a[d].object.____Path),d++;c(i,h)}e&&e(f),i.patches=f,f=[]};else{i={};for(var l,m=0,n=r.length;n>m;m++)if(r[m].obj===a){l=r[m];break}l||(l={obj:a},r.push(l)),l.value=JSON.parse(JSON.stringify(a)),e&&(i.callback=e,i.next=null,this.intervals=this.intervals||[100,1e3,1e4,6e4],i.currentInterval=0,"undefined"!=typeof d&&k(i),i.next=setTimeout(function(){j(i)},this.intervals[i.currentInterval++]))}return i.patches=f,i.object=a,g(i,a,f)}function g(a,b,c){if(Object.observe){Object.observe(b,a);for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];e&&"object"==typeof e&&g(a,e,c)}}return a}function h(a){l(a)}function i(b){clearTimeout(b.next),b.next=setTimeout(function(){h(b),b.currentInterval=0,b.next=setTimeout(function(){j(b)},a.intervals[b.currentInterval++])},0)}function j(b){h(b),b.currentInterval==a.intervals.length&&(b.currentInterval=a.intervals.length-1),b.next=setTimeout(function(){j(b)},a.intervals[b.currentInterval++])}function k(a){var b=function(){i(a)};d.addEventListener?(d.addEventListener("mousedown",b),d.addEventListener("mouseup",b),d.addEventListener("keydown",b),a.unbindWindowEvents=function(){d.removeEventListener("mousedown",b),d.removeEventListener("mouseup",b),d.removeEventListener("keydown",b)}):(d.attachEvent("onmousedown",b),d.attachEvent("onmouseup",b),d.attachEvent("onkeydown",b),a.unbindWindowEvents=function(){d.detachEvent("mousedown",b),d.detachEvent("mouseup",b),d.detachEvent("keydown",b)})}function l(a){if(Object.observe)Object.deliverChangeRecords(a);else{for(var b,c=0,d=r.length;d>c;c++)if(r[c].obj===a.object){b=r[c];break}m(b.value,a.object,a.patches,"")}var e=a.patches;return e.length>0&&(a.patches=[],a.callback&&a.callback(e)),e}function m(a,b,c,d){for(var e=s(b),f=s(a),g=!1,h=!1,i=0;i<f.length;i++){var j=f[i],k=a[j];if(b.hasOwnProperty(j)){var l=b[j];k instanceof Object?m(k,l,c,d+"/"+j):k!=l&&(g=!0,c.push({op:"replace",path:d+"/"+j,value:l}),a[j]=l)}else c.push({op:"remove",path:d+"/"+j}),h=!0}if(h||e.length!=f.length)for(var i=0;i<e.length;i++){var j=e[i];a.hasOwnProperty(j)||c.push({op:"add",path:d+"/"+j,value:b[j]})}}function n(a,b){for(var c,d=!1,e=0,f=b.length;f>e;){c=b[e];for(var g=c.path.split("/"),h=a,i=1,j=g.length;;)if(t(h)){var k=parseInt(g[i],10);if(i++,i>=j){d=p[c.op].call(c,h,k,a);break}h=h[k]}else{var l=g[i];if(-1!=l.indexOf("~")&&(l=l.replace("~1","/").replace("~0","~")),i++,i>=j){d=o[c.op].call(c,h,l,a);break}h=h[l]}e++}return d}var o={add:function(a,b){return a[b]=this.value,!0},remove:function(a,b){return delete a[b],!0},replace:function(a,b){return a[b]=this.value,!0},move:function(a,b,c){var d={op:"_get",path:this.from};return n(c,[d]),n(c,[{op:"remove",path:this.from}]),n(c,[{op:"add",path:this.path,value:d.value}]),!0},copy:function(a,b,c){var d={op:"_get",path:this.from};return n(c,[d]),n(c,[{op:"add",path:this.path,value:d.value}]),!0},test:function(a,b){return JSON.stringify(a[b])===JSON.stringify(this.value)},_get:function(a,b){this.value=a[b]}},p={add:function(a,b){a.splice(b,0,this.value)},remove:function(a,b){a.splice(b,1)},replace:function(a,b){a[b]=this.value},move:o.move,copy:o.copy,test:o.test,_get:o._get},q={"new":function(a,b){var c={op:"add",path:b+"/"+this.name,value:this.object[this.name]};a.push(c)},deleted:function(a,b){var c={op:"remove",path:b+"/"+this.name};a.push(c)},updated:function(a,b){var c={op:"replace",path:b+"/"+this.name,value:this.object[this.name]};a.push(c)}},r=[];a.intervals,a.unobserve=e,a.observe=f,a.generate=l;var s;s=Object.keys?Object.keys:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};var t;t=Array.isArray?Array.isArray:function(a){return a.push&&"number"==typeof a.length},a.apply=n}(U||(U={})),"undefined"!=typeof b&&(b.apply=U.apply,b.observe=U.observe,b.unobserve=U.unobserve,b.generate=U.generate),q.prototype.appear=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(!this.disabled){var n,o,p,q,r,s,t,u=this.instance,v=!1,w=!1,x=!1,y=!1;for(u.wtTable.isRowInViewport(a[0])||(v=!0),u.wtTable.isRowInViewport(a[2])||(x=!0),s=u.wtTable.rowStrategy.countVisible(),r=0;s>r;r++)if(t=u.wtTable.rowFilter.visibleToSource(r),t>=a[0]&&t<=a[2]){n=t;break}for(r=s-1;r>=0;r--)if(t=u.wtTable.rowFilter.visibleToSource(r),t>=a[0]&&t<=a[2]){p=t;break}if(v&&x)w=!0,y=!0;else{for(u.wtTable.isColumnInViewport(a[1])||(w=!0),u.wtTable.isColumnInViewport(a[3])||(y=!0),s=u.wtTable.columnStrategy.countVisible(),r=0;s>r;r++)if(t=u.wtTable.columnFilter.visibleToSource(r),t>=a[1]&&t<=a[3]){o=t;break}for(r=s-1;r>=0;r--)if(t=u.wtTable.columnFilter.visibleToSource(r),t>=a[1]&&t<=a[3]){q=t;break}}if(void 0===n||void 0===o)return this.disappear(),void 0;b=n!==p||o!==q,c=u.wtTable.getCell([n,o]),d=b?u.wtTable.getCell([p,q]):c,e=this.wtDom.offset(c),f=b?this.wtDom.offset(d):e,g=this.wtDom.offset(u.wtTable.TABLE),i=e.top,l=f.top+this.wtDom.outerHeight(d)-i,k=e.left,m=f.left+this.wtDom.outerWidth(d)-k,h=i-g.top-1,j=k-g.left-1;var z=this.wtDom.getComputedStyle(c);parseInt(z.borderTopWidth,10)>0&&(h+=1,l-=1),parseInt(z.borderLeftWidth,10)>0&&(j+=1,m-=1),v?this.topStyle.display="none":(this.topStyle.top=h+"px",this.topStyle.left=j+"px",this.topStyle.width=m+"px",this.topStyle.display="block"),w?this.leftStyle.display="none":(this.leftStyle.top=h+"px",this.leftStyle.left=j+"px",this.leftStyle.height=l+"px",this.leftStyle.display="block");var A=Math.floor(this.settings.border.width/2);x?this.bottomStyle.display="none":(this.bottomStyle.top=h+l-A+"px",this.bottomStyle.left=j+"px",this.bottomStyle.width=m+"px",this.bottomStyle.display="block"),y?this.rightStyle.display="none":(this.rightStyle.top=h+"px",this.rightStyle.left=j+m-A+"px",this.rightStyle.height=l+1+"px",this.rightStyle.display="block"),x||y||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=h+l-4+"px",this.cornerStyle.left=j+m-4+"px",this.cornerStyle.display="block")}},q.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},q.prototype.hasSetting=function(a){return"function"==typeof a?a():!!a},r.prototype.source=function(a){return a},r.prototype.offsetted=function(a){return a+this.offset},r.prototype.unOffsetted=function(a){return a-this.offset},r.prototype.fixed=function(a){return a<this.fixedCount?a-this.offset:a},r.prototype.unFixed=function(a){return a<this.fixedCount?a+this.offset:a},r.prototype.visibleToSource=function(a){return this.source(this.offsetted(this.fixed(a)))},r.prototype.sourceToVisible=function(a){return this.source(this.unOffsetted(this.unFixed(a)))},s.prototype.getSize=function(a){return this.cellSizes[a]},s.prototype.getContainerSize=function(a){return"function"==typeof this.containerSizeFn?this.containerSizeFn(a):this.containerSizeFn},s.prototype.countVisible=function(){return this.cellCount},s.prototype.isLastIncomplete=function(){return this.remainingSize>0},t.prototype.add=function(a,b,c){this.cache[a]||(this.cache[a]=[]),this.cache[a][b]||(this.cache[a][b]=[]),this.cache[a][b][c]=!0},t.prototype.test=function(a,b,c){return this.cache[a]&&this.cache[a][b]&&this.cache[a][b][c]},u.prototype=new r,u.prototype.readSettings=function(a){this.offset=a.wtSettings.settings.offsetColumn,this.total=a.getSetting("totalColumns"),this.fixedCount=a.getSetting("fixedColumnsLeft"),this.countTH=a.getSetting("rowHeaders").length},u.prototype.offsettedTH=function(a){return a-this.countTH},u.prototype.unOffsettedTH=function(a){return a+this.countTH},u.prototype.visibleRowHeadedColumnToSourceColumn=function(a){return this.visibleToSource(this.offsettedTH(a))},u.prototype.sourceColumnToVisibleRowHeadedColumn=function(a){return this.unOffsettedTH(this.sourceToVisible(a))},v.prototype=new s,v.prototype.getSize=function(a){return this.cellSizes[a]+(this.cellStretch[a]||0)},v.prototype.stretch=function(){var a=this.getContainerSize(this.cellSizesSum),b=0;if(this.remainingSize=this.cellSizesSum-a,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var c,d=a/this.cellSizesSum;b<this.cellCount-1;)c=Math.floor(d*this.cellSizes[b]),this.remainingSize+=c-this.cellSizes[b],this.cellStretch[b]=c-this.cellSizes[b],b++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},w.prototype.draw=function(a){return this.drawInterrupted=!1,a||this.wtDom.isVisible(this.wtTable.TABLE)?(this.getSetting("beforeDraw",!a),a=a&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(a),this.getSetting("onDraw",!a),this):(this.drawInterrupted=!0,void 0)},w.prototype.update=function(a,b){return this.wtSettings.update(a,b)},w.prototype.scrollVertical=function(a){return this.wtScroll.scrollVertical(a)},w.prototype.scrollHorizontal=function(a){return this.wtScroll.scrollHorizontal(a)},w.prototype.scrollViewport=function(a){return this.wtScroll.scrollViewport(a),this},w.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},w.prototype.getSetting=function(a,b,c,d){return this.wtSettings.getSetting(a,b,c,d)},w.prototype.hasSetting=function(a){return this.wtSettings.has(a)},w.prototype.destroy=function(){a(document.body).off("."+this.guid),this.wtScrollbars.destroy(),clearTimeout(this.wheelTimeout),clearTimeout(this.dblClickTimeout)},x.prototype.closest=function(a,b,c){for(;null!=a&&a!==c;){if(1===a.nodeType&&b.indexOf(a.nodeName)>-1)return a;a=a.parentNode}return null},x.prototype.isChildOf=function(a,b){for(var c=a.parentNode;null!=c;){if(c==b)return!0;c=c.parentNode}return!1},x.prototype.index=function(a){for(var b=0;a=a.previousSibling;)++b;return b},document.documentElement.classList?(x.prototype.hasClass=function(a,b){return a.classList.contains(b)},x.prototype.addClass=function(a,b){a.classList.add(b)},x.prototype.removeClass=function(a,b){a.classList.remove(b)}):(x.prototype.hasClass=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},x.prototype.addClass=function(a,b){this.hasClass(a,b)||(a.className+=" "+b)},x.prototype.removeClass=function(a,b){if(this.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}),x.prototype.removeTextNodes=function(a,b){if(3===a.nodeType)b.removeChild(a);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName)>-1)for(var c=a.childNodes,d=c.length-1;d>=0;d--)this.removeTextNodes(c[d],a)},x.prototype.empty=function(a){for(var b;b=a.lastChild;)a.removeChild(b)},x.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,x.prototype.fastInnerHTML=function(a,b){this.HTML_CHARACTERS.test(b)?a.innerHTML=b:this.fastInnerText(a,b)},x.prototype.fastInnerText=document.createTextNode("test").textContent?function(a,b){var c=a.firstChild;c&&3===c.nodeType&&null===c.nextSibling?c.textContent=b:(this.empty(a),a.appendChild(document.createTextNode(b)))}:function(a,b){var c=a.firstChild;c&&3===c.nodeType&&null===c.nextSibling?c.data=b:(this.empty(a),a.appendChild(document.createTextNode(b)))},x.prototype.isVisible=function(a){try{if(!a.offsetParent)return!1}catch(b){return!1}if(a.offsetWidth>0)return!0;for(var c=a;c!==document.documentElement;){if(null===c)return!1;if(11===c.nodeType)return!0;if("none"===c.style.display)return!1;c=c.parentNode}return!0},x.prototype.offset=function(a){if(this.hasCaptionProblem()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName){var b=a.getBoundingClientRect();return{top:b.top+(d.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:b.left+(d.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var c=a.offsetLeft,e=a.offsetTop,f=a;(a=a.offsetParent)&&a!==document.body;)c+=a.offsetLeft,e+=a.offsetTop,f=a;return f&&"fixed"===f.style.position&&(c+=d.pageXOffset||document.documentElement.scrollLeft,e+=d.pageYOffset||document.documentElement.scrollTop),{left:c,top:e}},x.prototype.getComputedStyle=function(a){return a.currentStyle||document.defaultView.getComputedStyle(a)},x.prototype.outerWidth=function(a){return a.offsetWidth},x.prototype.outerHeight=function(a){return this.hasCaptionProblem()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName?a.offsetHeight+a.firstChild.offsetHeight:a.offsetHeight},function(){function a(){var a=document.createElement("TABLE");a.style.borderSpacing=0,a.style.borderWidth=0,a.style.padding=0;var c=document.createElement("TBODY");a.appendChild(c),c.appendChild(document.createElement("TR")),c.firstChild.appendChild(document.createElement("TD")),c.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var d=document.createElement("CAPTION");d.innerHTML="c<br>c<br>c<br>c",d.style.padding=0,d.style.margin=0,a.insertBefore(d,c),document.body.appendChild(a),b=a.offsetHeight<2*a.lastChild.offsetHeight,document.body.removeChild(a)}var b;x.prototype.hasCaptionProblem=function(){return void 0===b&&a(),b}}(),y.prototype.parentCell=function(a){var b={},c=this.instance.wtTable.TABLE,d=this.wtDom.closest(a,["TD","TH"],c);return d&&this.wtDom.isChildOf(d,c)?(b.coords=this.instance.wtTable.getCoords(d),b.TD=d):this.wtDom.hasClass(a,"wtBorder")&&this.wtDom.hasClass(a,"current")&&!this.wtDom.hasClass(a,"corner")&&(b.coords=this.instance.selections.current.selected[0],b.TD=this.instance.wtTable.getCell(b.coords)),b},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),d.requestAnimFrame=function(){return d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame||function(a){return d.setTimeout(a,1e3/60)}}(),d.cancelRequestAnimFrame=function(){return d.cancelAnimationFrame||d.webkitCancelRequestAnimationFrame||d.mozCancelRequestAnimationFrame||d.oCancelRequestAnimationFrame||d.msCancelRequestAnimationFrame||clearTimeout}(),d.getComputedStyle||function(){var a,b={getPropertyValue:function(b){return"float"==b&&(b="styleFloat"),a.currentStyle[b.toUpperCase()]||null}};d.getComputedStyle=function(c){return a=c,b}}(),z.prototype=new r,z.prototype.readSettings=function(a){this.offset=a.wtSettings.settings.offsetRow,this.total=a.getSetting("totalRows"),this.fixedCount=a.getSetting("fixedRowsTop")},A.prototype=new s,A.prototype.add=function(a,b,c){if(this.remainingSize<0){var d=this.sizeAtIndex(a,b);if(void 0===d)return;var e=this.getContainerSize(this.cellSizesSum+d);if(c?this.cellSizes.unshift(d):this.cellSizes.push(d),this.cellSizesSum+=d,this.cellCount++,this.remainingSize=this.cellSizesSum-e,c&&this.remainingSize>0)for(;this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize;)this.cellSizesSum-=this.cellSizes[this.cellCount-1],this.cellCount--,this.cellSizes.length=this.cellCount}},A.prototype.remove=function(){var a=this.cellSizes.pop();this.cellSizesSum-=a,this.cellCount--,this.remainingSize+=a},B.prototype.scrollVertical=function(a){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var b,c=this.instance,d=c.getSetting("offsetRow"),e=c.getSetting("fixedRowsTop"),f=c.getSetting("totalRows"),g=c.wtViewport.getViewportHeight();return b=f>0?this.scrollLogicVertical(a,d,f,e,g,function(a){return e>a-d&&a-d>=0?c.getSetting("rowHeight",a-d):c.getSetting("rowHeight",a)},function(a){c.wtTable.verticalRenderReverse=a}):0,b!==d&&this.instance.wtScrollbars.vertical.scrollTo(b),c},B.prototype.scrollHorizontal=function(a){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var b,c=this.instance,d=c.getSetting("offsetColumn"),e=c.getSetting("fixedColumnsLeft"),f=c.getSetting("totalColumns"),g=c.wtViewport.getViewportWidth();return b=f>0?this.scrollLogicHorizontal(a,d,f,e,g,function(a){return e>a-d&&a-d>=0?c.getSetting("columnWidth",a-d):c.getSetting("columnWidth",a)}):0,b!==d&&this.instance.wtScrollbars.horizontal.scrollTo(b),c},B.prototype.scrollLogicVertical=function(a,b,c,d,e,f,g){var h=b+a;return h>=c-d&&(h=c-d-1,g(!0)),0>h&&(h=0),h},B.prototype.scrollLogicHorizontal=function(a,b,c,d,e,f){var g,h=b+a,i=0;if(h>d){for(h>=c-d&&(h=c-d-1),g=h;e>i&&c>g;)i+=f(g),g++;if(e>i)for(;h>0&&(i+=f(h-1),e>i);)h--}else 0>h&&(h=0);return h},B.prototype.scrollViewport=function(a){var b=this.instance.getSetting("offsetRow"),c=(this.instance.getSetting("offsetColumn"),this.instance.wtTable.getLastVisibleRow()),d=this.instance.getSetting("totalRows"),e=this.instance.getSetting("totalColumns"),f=this.instance.getSetting("fixedRowsTop"),g=this.instance.getSetting("fixedColumnsLeft");if(a[0]<0||a[0]>d-1)throw new Error("row "+a[0]+" does not exist");if(a[1]<0||a[1]>e-1)throw new Error("column "+a[1]+" does not exist");if(a[0]>c?(this.scrollVertical(a[0]-f-b),this.instance.wtTable.verticalRenderReverse=!0):a[0]===c&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(a[0]-f-b),this.instance.wtTable.verticalRenderReverse=!0):a[0]-f<b?this.scrollVertical(a[0]-f-b):this.scrollVertical(0),this.instance.wtTable.isColumnBeforeViewport(a[1]))this.instance.wtScrollbars.horizontal.scrollTo(a[1]-g);else if(this.instance.wtTable.isColumnAfterViewport(a[1])||this.instance.wtTable.getLastVisibleColumn()===a[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(var h=0,i=0;g>i;i++)h+=this.instance.getSetting("columnWidth",i);var j=a[1];h+=this.instance.getSetting("columnWidth",j);var k=this.instance.wtViewport.getViewportWidth();if(k>h)for(var l=this.instance.getSetting("columnWidth",j-1);k>h+l&&j>=g;)j--,h+=l;this.instance.wtScrollbars.horizontal.scrollTo(j-g)}return this.instance},C.prototype.init=function(){var b=this;this.$table=a(this.instance.wtTable.TABLE),this.slider=document.createElement("DIV"),this.sliderStyle=this.slider.style,this.sliderStyle.position="absolute",this.sliderStyle.top="0",this.sliderStyle.left="0",this.sliderStyle.display="none",this.slider.className="dragdealer "+this.type,this.handle=document.createElement("DIV"),this.handleStyle=this.handle.style,this.handle.className="handle",this.slider.appendChild(this.handle),this.container=this.instance.wtTable.parent,this.container.appendChild(this.slider);var c=!0;this.dragTimeout=null;var d,e=function(){b.onScroll(d)};this.dragdealer=new _(this.slider,{vertical:"vertical"===this.type,horizontal:"horizontal"===this.type,slide:!1,speed:100,animationCallback:function(a,f){return c?(c=!1,void 0):(b.skipRefresh=!0,d="vertical"===b.type?f:a,null===b.dragTimeout&&(b.dragTimeout=setInterval(e,100),e()),void 0)},callback:function(a,c){b.skipRefresh=!1,clearInterval(b.dragTimeout),b.dragTimeout=null,d="vertical"===b.type?c:a,b.onScroll(d)}}),this.skipRefresh=!1},C.prototype.onScroll=function(a){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var b=Math.round(this.handlePosition*this.total/this.sliderSize);1===a?"vertical"===this.type?this.instance.scrollVertical(1/0).draw():this.instance.scrollHorizontal(1/0).draw():b!==this.offset?"vertical"===this.type?this.instance.scrollVertical(b-this.offset).draw():this.instance.scrollHorizontal(b-this.offset).draw():this.refresh()}},C.prototype.getHandleSizeRatio=function(a,b){return!b||a>b||a==b?1:1/b},C.prototype.prepare=function(){if(!this.skipRefresh){var a=this.getHandleSizeRatio(this.visibleCount,this.total);this.visible=(1===a||isNaN(a))&&"auto"===this.scrollMode||"none"===this.scrollMode?!1:!0}},C.prototype.refresh=function(){if(!this.skipRefresh){if(!this.visible)return this.sliderStyle.display="none",void 0;var a,b,c,d,e=this.visibleCount,f=this.instance.wtViewport.getWorkspaceWidth(),g=this.instance.wtViewport.getWorkspaceHeight();1/0===f&&(f=this.instance.wtViewport.getWorkspaceActualWidth()),1/0===g&&(g=this.instance.wtViewport.getWorkspaceActualHeight()),"vertical"===this.type?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&e--,b=g-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=f-1+"px",this.sliderStyle.height=Math.max(b,0)+"px"):(b=f-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=g-1+"px",this.sliderStyle.width=Math.max(b,0)+"px"),a=this.getHandleSizeRatio(e,this.total),c=Math.round(b*a),10>c&&(c=15),d=Math.floor(b*(this.offset/this.total)),c+d>b&&(d=b-c),"vertical"===this.type?(this.handleStyle.height=c+"px",this.handleStyle.top=d+"px"):(this.handleStyle.width=c+"px",this.handleStyle.left=d+"px"),this.sliderStyle.display="block"}},C.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var V=function(a){this.instance=a,this.type="vertical",this.init()};V.prototype=new C,V.prototype.scrollTo=function(a){this.instance.update("offsetRow",a)},V.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV"),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows"),this.visibleCount=this.instance.wtTable.rowStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.top,10),this.sliderSize=parseInt(this.sliderStyle.height,10),this.fixedCount=this.instance.getSetting("fixedRowsTop")};var W=function(a){this.instance=a,this.type="horizontal",this.init()};W.prototype=new C,W.prototype.scrollTo=function(a){this.instance.update("offsetColumn",a)},W.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH"),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns"),this.visibleCount=this.instance.wtTable.columnStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.left,10),this.sliderSize=parseInt(this.sliderStyle.width,10),this.fixedCount=this.instance.getSetting("fixedColumnsLeft")},W.prototype.getHandleSizeRatio=function(a,b){return!b||a>b||a==b?1:a/b},D.prototype.init=function(){this.fixedContainer=this.instance.wtTable.TABLE.parentNode.parentNode.parentNode,this.fixed=this.instance.wtTable.TABLE.parentNode.parentNode,this.TABLE=this.instance.wtTable.TABLE,this.$scrollHandler=a(d);var b=this;this.$scrollHandler.on("scroll.walkontable",function(){return b.instance.wtTable.parent.parentNode?(b.onScroll(),void 0):(b.destroy(),void 0)}),this.readSettings()},D.prototype.onScroll=function(){if(this.readSettings(),this.windowScrollPosition!==this.lastWindowScrollPosition){this.lastWindowScrollPosition=this.windowScrollPosition;var a,b=0;this.windowScrollPosition>this.tableParentOffset&&(a=this.windowScrollPosition-this.tableParentOffset,b=Math.ceil(a/20,10),b=Math.min(b,this.total)),this.instance.update("offsetRow",b),this.instance.draw()}},D.prototype.prepare=function(){},D.prototype.availableSize=function(){var a;return a=this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-(this.tableParentOffset-this.windowScrollPosition)},D.prototype.refresh=function(){var a=this.getLastCell();this.measureBefore=this.offset*this.cellSize,this.measureInside=this.getTableSize(),this.measureAfter=-1===a?0:(this.total-a-1)*this.cellSize,this.applyToDOM()},D.prototype.destroy=function(){this.$scrollHandler.off("scroll.walkontable")};var X=function(a){this.instance=a,this.type="vertical",this.cellSize=20,this.init()};X.prototype=new D,X.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleRow()},X.prototype.getTableSize=function(){return this.instance.wtDom.outerHeight(this.TABLE)},X.prototype.applyToDOM=function(){this.windowScrollPosition>this.tableParentOffset?(this.fixed.style.position="fixed",this.fixed.style.top="0",this.fixed.style.left=this.tableParentOtherOffset):this.fixed.style.position="relative";var a=!1;a||(this.fixedContainer.style.paddingTop=this.measureBefore+"px",this.fixedContainer.style.paddingBottom=this.measureInside+this.measureAfter+"px")},X.prototype.scrollTo=function(a){this.$scrollHandler.scrollTop(this.tableParentOffset+a*this.cellSize)},X.prototype.readSettings=function(){var a=this.instance.wtDom.offset(this.fixedContainer);this.tableParentOffset=a.top,this.tableParentOtherOffset=a.left,this.windowSize=this.$scrollHandler.height(),this.windowScrollPosition=this.$scrollHandler.scrollTop(),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows")};var Y=function(a){this.instance=a,this.type="horizontal",this.cellSize=50,this.init()};Y.prototype=new D,Y.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},Y.prototype.getTableSize=function(){return this.instance.wtDom.outerWidth(this.TABLE)},Y.prototype.applyToDOM=function(){this.windowScrollPosition>this.tableParentOffset?(this.fixed.style.position="fixed",this.fixed.style.left="0",this.fixed.style.top=this.tableParentOtherOffset):this.fixed.style.position="relative";var a=!1;a||(this.fixedContainer.style.paddingLeft=this.measureBefore+"px",this.fixedContainer.style.paddingRight=this.measureInside+this.measureAfter+"px")},Y.prototype.scrollTo=function(a){this.$scrollHandler.scrollLeft(this.tableParentOffset+a*this.cellSize)},Y.prototype.readSettings=function(){var a=this.instance.wtDom.offset(this.fixedContainer);this.tableParentOffset=a.left,this.tableParentOtherOffset=a.top,this.windowSize=this.$scrollHandler.width(),this.windowScrollPosition=this.$scrollHandler.scrollLeft(),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns")},E.prototype.destroy=function(){this.vertical.destroy(),this.horizontal.destroy()},E.prototype.refresh=function(){this.horizontal.readSettings(),this.vertical.readSettings(),this.horizontal.prepare(),this.vertical.prepare(),this.horizontal.refresh(),this.vertical.refresh()},F.prototype.add=function(a){this.selected.push(a)},F.prototype.clear=function(){this.selected.length=0},F.prototype.getCorners=function(){var a,b,c,d,e,f=this.selected.length;if(f>0&&(a=c=this.selected[0][0],b=d=this.selected[0][1],f>1))for(e=1;f>e;e++)this.selected[e][0]<a?a=this.selected[e][0]:this.selected[e][0]>c&&(c=this.selected[e][0]),this.selected[e][1]<b?b=this.selected[e][1]:this.selected[e][1]>d&&(d=this.selected[e][1]);return[a,b,c,d]},F.prototype.draw=function(){var a,b,c,d,e,f=this.instance.wtTable.rowStrategy.countVisible(),g=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(a=this.getCorners(),b=0;f>b;b++)for(c=0;g>c;c++)d=this.instance.wtTable.rowFilter.visibleToSource(b),e=this.instance.wtTable.columnFilter.visibleToSource(c),d>=a[0]&&d<=a[2]&&e>=a[1]&&e<=a[3]?this.instance.wtTable.currentCellCache.add(b,c,this.settings.className):d>=a[0]&&d<=a[2]?this.instance.wtTable.currentCellCache.add(b,c,this.settings.highlightRowClassName):e>=a[1]&&e<=a[3]&&this.instance.wtTable.currentCellCache.add(b,c,this.settings.highlightColumnClassName);this.border&&this.border.appear(a)}else this.border&&this.border.disappear()},G.prototype.update=function(a,b){if(void 0===b)for(var c in a)a.hasOwnProperty(c)&&(this.settings[c]=a[c]);else this.settings[a]=b;return this.instance},G.prototype.getSetting=function(a,b,c,d){return this[a]?this[a](b,c,d):this._getSetting(a,b,c,d)},G.prototype._getSetting=function(a,b,c,d){return"function"==typeof this.settings[a]?this.settings[a](b,c,d):void 0!==b&&"[object Array]"===Object.prototype.toString.call(this.settings[a])?this.settings[a][b]:this.settings[a]},G.prototype.has=function(a){return!!this.settings[a]},G.prototype.rowHeight=function(a){var b=this.instance.wtTable.rowFilter.sourceToVisible(a),c=this.instance.wtTable.rowStrategy.getSize(b);return void 0!==c?c:20},H.prototype.refreshHiderDimensions=function(){var a=this.instance.wtViewport.getWorkspaceHeight(),b=this.instance.wtViewport.getWorkspaceWidth(),c=this.spreader.style;
1/0!==a||1/0!==b?(1/0===a&&(a=this.instance.wtViewport.getWorkspaceActualHeight()),1/0===b&&(b=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",c.position="absolute",c.top="0",c.left="0","dragdealer"===this.instance.getSetting("scrollbarModelV")&&(c.height="4000px"),"dragdealer"===this.instance.getSetting("scrollbarModelH")&&(c.width="4000px"),0>a&&(a=0),this.hiderStyle.height=a+"px",this.hiderStyle.width=b+"px"):(c.position="relative",c.width="auto",c.height="auto")},H.prototype.refreshStretching=function(){var a=this.instance,b=a.getSetting("stretchH"),c=a.getSetting("totalRows"),d=a.getSetting("totalColumns"),e=a.getSetting("offsetColumn"),f=function(a){return g.instance.wtViewport.getViewportWidth(a)},g=this,h=function(b){var c=g.columnFilter.visibleToSource(b);return d>c?a.getSetting("columnWidth",c):void 0};"hybrid"===b&&(b=e>0?"last":"none");var i=function(a){return g.instance.wtViewport.getViewportHeight(a)},j=function(a,b){var d=g.rowFilter.visibleToSource(a);return c>d?g.verticalRenderReverse&&0===a?g.wtDom.outerHeight(b)-1:g.wtDom.outerHeight(b):void 0};this.columnStrategy=new v(f,h,b),this.rowStrategy=new A(i,j)},H.prototype.adjustAvailableNodes=function(){for(var a,b,c,d,e=this.instance.getSetting("rowHeaders"),f=e.length,g=this.instance.getSetting("columnHeaders");this.colgroupChildrenLength<f;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),a=this.columnStrategy.cellCount;this.colgroupChildrenLength<a+f;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(;this.colgroupChildrenLength>a+f;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(b=this.THEAD.firstChild,g.length){for(b||(b=document.createElement("TR"),this.THEAD.appendChild(b)),this.theadChildrenLength=b.childNodes.length;this.theadChildrenLength<a+f;)b.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>a+f;)b.removeChild(b.lastChild),this.theadChildrenLength--}else b&&this.wtDom.empty(b);for(d=0;d<this.colgroupChildrenLength;d++)f>d?this.wtDom.addClass(this.COLGROUP.childNodes[d],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[d],"rowHeader");if(g.length&&(b=this.THEAD.firstChild,f))for(c=b.firstChild,d=0;f>d;d++)e[d](-f+d,c),c=c.nextSibling;for(d=0;a>d;d++)g.length&&g[0](this.columnFilter.visibleToSource(d),b.childNodes[f+d])},H.prototype.adjustColumns=function(a,b){for(var c=a.childNodes.length;b>c;){var d=document.createElement("TD");a.appendChild(d),c++}for(;c>b;)a.removeChild(a.lastChild),c--},H.prototype.draw=function(a){return this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),a?this.instance.wtScrollbars.refresh():(this.tableOffset=this.wtDom.offset(this.TABLE),this._doDraw()),this.refreshPositions(a),this.instance.drawn=!0,this},H.prototype._doDraw=function(){var a,b,c,d,e,f,g,h,i,j=0,k=this.instance.getSetting("offsetRow"),l=this.instance.getSetting("totalRows"),m=this.instance.getSetting("totalColumns"),n=this.instance.getSetting("rowHeaders"),o=n.length,p=!1;this.verticalRenderReverse&&(i=k),this.instance.wtViewport.resetSettings();var q=!1;if(this.verticalRenderReverse&&(k===l-this.rowFilter.fixedCount-1?q=!0:(this.instance.update("offsetRow",k+1),this.rowFilter.readSettings(this.instance))),m>0){a=this.rowFilter.visibleToSource(j);for(var r=!0;l>a&&a>=0;){if(j>=this.tbodyChildrenLength||this.verticalRenderReverse&&j>=this.rowFilter.fixedCount){for(e=document.createElement("TR"),b=0;o>b;b++)e.appendChild(document.createElement("TH"));this.verticalRenderReverse&&j>=this.rowFilter.fixedCount?this.TBODY.insertBefore(e,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(e),this.tbodyChildrenLength++}else e=0===j?this.TBODY.firstChild:e.nextSibling;for(g=e.firstChild,b=0;o>b;b++)"TD"==g.nodeName&&(f=g,g=document.createElement("TH"),e.insertBefore(g,f),e.removeChild(f)),n[b](a,g),g=g.nextSibling;if(r)for(r=!1,this.adjustAvailableNodes(),p=!0,d=this.columnStrategy.cellCount,this.adjustColumns(e,d+o),h=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch(),b=0;d>b;b++)this.COLGROUP.childNodes[b+o].style.width=this.columnStrategy.getSize(b)+"px";else this.adjustColumns(e,d+o);for(b=0;d>b;b++)c=this.columnFilter.visibleToSource(b),f=0===b?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(c)]:f.nextSibling,"TH"==f.nodeName&&(g=f,f=document.createElement("TD"),e.insertBefore(f,g),e.removeChild(g)),f.className="",f.removeAttribute("style"),this.instance.getSetting("cellRenderer",a,c,f);if(k=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&q){if(-this.wtDom.outerHeight(e.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(e),this.instance.update("offsetRow",k+1),this.tbodyChildrenLength--,this.rowFilter.readSettings(this.instance);break}this.rowStrategy.add(j,f,this.verticalRenderReverse)}else if(this.rowStrategy.add(j,f,this.verticalRenderReverse),this.rowStrategy.isLastIncomplete()){if(this.verticalRenderReverse&&!this.isRowInViewport(i))return this.verticalRenderReverse=!1,this.instance.update("offsetRow",i),this.draw(),void 0;break}if(this.verticalRenderReverse&&j>=this.rowFilter.fixedCount){if(0===k)break;this.instance.update("offsetRow",k-1),this.rowFilter.readSettings(this.instance)}else j++;a=this.rowFilter.visibleToSource(j)}}for(p||this.adjustAvailableNodes(),j=this.rowStrategy.countVisible();this.tbodyChildrenLength>j;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars.refresh(),h!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),b=0;b<this.columnStrategy.cellCount;b++)this.COLGROUP.childNodes[b+o].style.width=this.columnStrategy.getSize(b)+"px";this.verticalRenderReverse=!1},H.prototype.refreshPositions=function(a){this.refreshHiderDimensions(),this.refreshSelections(a)},H.prototype.refreshSelections=function(a){var b,c,d,e,f,g,h=[],i=this.rowStrategy.countVisible(),j=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new t,this.instance.selections)for(c in this.instance.selections)this.instance.selections.hasOwnProperty(c)&&(this.instance.selections[c].draw(),this.instance.selections[c].settings.className&&h.push(this.instance.selections[c].settings.className),this.instance.selections[c].settings.highlightRowClassName&&h.push(this.instance.selections[c].settings.highlightRowClassName),this.instance.selections[c].settings.highlightColumnClassName&&h.push(this.instance.selections[c].settings.highlightColumnClassName));for(g=h.length,b=0;i>b;b++)for(d=0;j>d;d++)for(c=this.rowFilter.visibleToSource(b),e=this.columnFilter.visibleToSource(d),f=0;g>f;f++)this.currentCellCache.test(b,d,h[f])?this.wtDom.addClass(this.getCell([c,e]),h[f]):a&&this.oldCellCache.test(b,d,h[f])&&this.wtDom.removeClass(this.getCell([c,e]),h[f])},H.prototype.getCell=function(a){return this.isRowBeforeViewport(a[0])?-1:this.isRowAfterViewport(a[0])?-2:this.isColumnBeforeViewport(a[1])?-3:this.isColumnAfterViewport(a[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(a[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(a[1])]},H.prototype.getCoords=function(a){return[this.rowFilter.visibleToSource(this.wtDom.index(a.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(a.cellIndex)]},H.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)},H.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)},H.prototype.isRowBeforeViewport=function(a){return this.rowFilter.sourceToVisible(a)<this.rowFilter.fixedCount&&a>=this.rowFilter.fixedCount},H.prototype.isRowAfterViewport=function(a){return a>this.getLastVisibleRow()},H.prototype.isColumnBeforeViewport=function(a){return this.columnFilter.sourceToVisible(a)<this.columnFilter.fixedCount&&a>=this.columnFilter.fixedCount},H.prototype.isColumnAfterViewport=function(a){return a>this.getLastVisibleColumn()},H.prototype.isRowInViewport=function(a){return!this.isRowBeforeViewport(a)&&!this.isRowAfterViewport(a)},H.prototype.isColumnInViewport=function(a){return!this.isColumnBeforeViewport(a)&&!this.isColumnAfterViewport(a)},H.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()},H.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()},I.prototype.getWorkspaceHeight=function(a){var b=this.instance.getSetting("height");return(1/0===b||void 0===b||null===b||1>b)&&(b=this.instance.wtScrollbars.vertical instanceof D?this.instance.wtScrollbars.vertical.availableSize():1/0),1/0!==b&&(a>=b?b-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(b-=this.instance.getSetting("scrollbarHeight"))),b},I.prototype.getWorkspaceWidth=function(a){var b=this.instance.getSetting("width");return(1/0===b||void 0===b||null===b||1>b)&&(b=this.instance.wtScrollbars.horizontal instanceof D?this.instance.wtScrollbars.horizontal.availableSize():1/0),1/0!==b&&(a>=b?b-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(b-=this.instance.getSetting("scrollbarWidth"))),b},I.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)},I.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)},I.prototype.getViewportHeight=function(a){var b=this.getWorkspaceHeight(a);if(1/0===b)return b;if(isNaN(this.columnHeaderHeight)){var c=this.instance.wtDom.offset(this.instance.wtTable.TBODY),d=this.instance.wtTable.tableOffset;this.columnHeaderHeight=c.top-d.top}return this.columnHeaderHeight>0?b-this.columnHeaderHeight:b},I.prototype.getViewportWidth=function(a){var b=this.getWorkspaceWidth(a);if(1/0===b)return b;if(isNaN(this.rowHeaderWidth)){var c=this.instance.wtTable.TBODY?this.instance.wtTable.TBODY.firstChild:null;if(c){var d=c.firstChild;for(this.rowHeaderWidth=0;d&&"TH"===d.nodeName;)this.rowHeaderWidth+=this.instance.wtDom.outerWidth(d),d=d.nextSibling}}return this.rowHeaderWidth>0?b-this.rowHeaderWidth:b},I.prototype.resetSettings=function(){this.rowHeaderWidth=0/0,this.columnHeaderHeight=0/0};var Z={x:0,y:0,init:function(){this.setEvent("mouse"),this.setEvent("touch")},setEvent:function(a){var b=document["on"+a+"move"]||function(){};document["on"+a+"move"]=function(a){b(a),Z.refresh(a)}},refresh:function(a){a||(a=d.event),"mousemove"==a.type?this.set(a):a.touches&&this.set(a.touches[0])},set:function(a){a.pageX||a.pageY?(this.x=a.pageX,this.y=a.pageY):(a.clientX||a.clientY)&&(this.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};Z.init();var $={get:function(a){var b=0,c=0;if(a.offsetParent)do c+=a.offsetLeft,b+=a.offsetTop;while(a=a.offsetParent);return[c,b]}},_=function(a,b){if("string"==typeof a&&(a=document.getElementById(a)),a){var c=a.getElementsByTagName("div")[0];c&&-1!=c.className.search(/(^|\s)handle(\s|$)/)&&(this.init(a,c,b||{}),this.setup())}};_.prototype={init:function(a,b,c){this.wrapper=a,this.handle=b,this.options=c,this.disabled=this.getOption("disabled",!1),this.horizontal=this.getOption("horizontal",!0),this.vertical=this.getOption("vertical",!1),this.slide=this.getOption("slide",!0),this.steps=this.getOption("steps",0),this.snap=this.getOption("snap",!1),this.loose=this.getOption("loose",!1),this.speed=this.getOption("speed",10)/100,this.xPrecision=this.getOption("xPrecision",0),this.yPrecision=this.getOption("yPrecision",0),this.callback=c.callback||null,this.animationCallback=c.animationCallback||null,this.bounds={left:c.left||0,right:-(c.right||0),top:c.top||0,bottom:-(c.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0},this.value={prev:[-1,-1],current:[c.x||0,c.y||0],target:[c.x||0,c.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.activity=!1,this.dragging=!1,this.tapping=!1},getOption:function(a,b){return void 0!==this.options[a]?this.options[a]:b},setup:function(){this.setWrapperOffset(),this.setBoundsPadding(),this.setBounds(),this.setSteps(),this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=$.get(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=$.get(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left),this.bounds.top||this.bounds.bottom||(this.bounds.top=$.get(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left,this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right,this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth,this.bounds.y0=this.bounds.top,this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom,this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight,this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth)),this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var a=0;a<=this.steps-1;a++)this.stepRatios[a]=a/(this.steps-1)}},addListeners:function(){var a=this;this.wrapper.onselectstart=function(){return!1},this.handle.onmousedown=this.handle.ontouchstart=function(b){a.handleDownHandler(b)},this.wrapper.onmousedown=this.wrapper.ontouchstart=function(b){a.wrapperDownHandler(b)};var b=document.onmouseup||function(){};document.onmouseup=function(c){b(c),a.documentUpHandler(c)};var c=document.ontouchend||function(){};document.ontouchend=function(b){c(b),a.documentUpHandler(b)};var e=d.onresize||function(){};d.onresize=function(b){e(b),a.documentResizeHandler(b)},this.wrapper.onmousemove=function(){a.activity=!0},this.wrapper.onclick=function(){return!a.activity},this.interval=setInterval(function(){a.animate()},25),a.animate(!1,!0)},handleDownHandler:function(a){this.activity=!1,Z.refresh(a),this.preventDefaults(a,!0),this.startDrag()},wrapperDownHandler:function(a){Z.refresh(a),this.preventDefaults(a,!0),this.startTap()},documentUpHandler:function(){this.stopDrag(),this.stopTap()},documentResizeHandler:function(){this.setWrapperOffset(),this.setBounds(),this.update()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},setStep:function(a,b,c){this.setValue(this.steps&&a>1?(a-1)/(this.steps-1):0,this.steps&&b>1?(b-1)/(this.steps-1):0,c)},setValue:function(a,b,c){this.setTargetValue([a,b||0]),c&&this.groupCopy(this.value.current,this.value.target)},startTap:function(a){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),void 0===a&&(a=[Z.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,Z.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(a))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[Z.x-$.get(this.handle)[0],Z.y-$.get(this.handle)[1]],this.dragging=!0)},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var a=this.groupClone(this.value.current);if(this.slide){var b=this.change;a[0]+=4*b[0],a[1]+=4*b[1]}this.setTargetValue(a),this.result()}},feedback:function(){var a=this.value.current;this.snap&&this.steps>1&&(a=this.getClosestSteps(a)),this.groupCompare(a,this.value.prev)||("function"==typeof this.animationCallback&&this.animationCallback(a[0],a[1]),this.groupCopy(this.value.prev,a))},result:function(){"function"==typeof this.callback&&this.callback(this.value.target[0],this.value.target[1])},animate:function(a,b){if(!a||this.dragging){if(this.dragging){var c=this.groupClone(this.value.target),d=[Z.x-this.offset.wrapper[0]-this.offset.mouse[0],Z.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(d,this.loose),this.change=[this.value.target[0]-c[0],this.value.target[1]-c[1]]}(this.dragging||b)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||b)&&(this.update(),this.feedback())}},glide:function(){var a=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return a[0]||a[1]?(Math.abs(a[0])>this.bounds.xStep||Math.abs(a[1])>this.bounds.yStep?(this.value.current[0]+=a[0]*this.speed,this.value.current[1]+=a[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0):!1},update:function(){this.offset.current=this.snap?this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.getOffsetsByRatios(this.value.current),this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(a,b){var c=b?this.getLooseValue(a):this.getProperValue(a);this.groupCopy(this.value.target,c),this.offset.target=this.getOffsetsByRatios(c)},setTargetOffset:function(a,b){var c=this.getRatiosByOffsets(a),d=b?this.getLooseValue(c):this.getProperValue(c);this.groupCopy(this.value.target,d),this.offset.target=this.getOffsetsByRatios(d)},getLooseValue:function(a){var b=this.getProperValue(a);return[b[0]+(a[0]-b[0])/4,b[1]+(a[1]-b[1])/4]},getProperValue:function(a){var b=this.groupClone(a);return b[0]=Math.max(b[0],0),b[1]=Math.max(b[1],0),b[0]=Math.min(b[0],1),b[1]=Math.min(b[1],1),(!this.dragging&&!this.tapping||this.snap)&&this.steps>1&&(b=this.getClosestSteps(b)),b},getRatiosByOffsets:function(a){return[this.getRatioByOffset(a[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(a[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(a,b,c){return b?(a-c)/b:0},getOffsetsByRatios:function(a){return[this.getOffsetByRatio(a[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(a[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(a,b,c){return Math.round(a*b)+c},getClosestSteps:function(a){return[this.getClosestStep(a[0]),this.getClosestStep(a[1])]},getClosestStep:function(a){for(var b=0,c=1,d=0;d<=this.steps-1;d++)Math.abs(this.stepRatios[d]-a)<c&&(c=Math.abs(this.stepRatios[d]-a),b=d);return this.stepRatios[b]},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0],a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},preventDefaults:function(a,b){a||(a=d.event),a.preventDefault&&a.preventDefault(),a.returnValue=!1,b&&document.selection&&document.selection.empty()},cancelEvent:function(a){a||(a=d.event),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0}},jQuery.browser||function(){var a,b;jQuery.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=jQuery.uaMatch(navigator.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),jQuery.browser=b}(),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof b?c.exports=a:a(jQuery)}(function(a){function b(b){var f,g=b||d.event,h=[].slice.call(arguments,1),i=0,j=0,k=0,l=0,m=0;return b=a.event.fix(g),b.type="mousewheel",g.wheelDelta&&(i=g.wheelDelta),g.detail&&(i=-1*g.detail),g.deltaY&&(k=-1*g.deltaY,i=k),g.deltaX&&(j=g.deltaX,i=-1*j),void 0!==g.wheelDeltaY&&(k=g.wheelDeltaY),void 0!==g.wheelDeltaX&&(j=-1*g.wheelDeltaX),l=Math.abs(i),(!c||c>l)&&(c=l),m=Math.max(Math.abs(k),Math.abs(j)),(!e||e>m)&&(e=m),f=i>0?"floor":"ceil",i=Math[f](i/c),j=Math[f](j/e),k=Math[f](k/e),h.unshift(b,i,j,k),(a.event.dispatch||a.event.handle).apply(this,h)}var c,e,f=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],g="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(a.event.fixHooks)for(var h=f.length;h;)a.event.fixHooks[f[--h]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=g.length;a;)this.addEventListener(g[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=g.length;a;)this.removeEventListener(g[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),Array.prototype.filter||(Array.prototype.filter=function(a,b){function c(a){return/NodeList/i.test(a.item)}function d(a){for(var b=[],c=0,d=a.length;d>c;c++)b[c]=a[c];return b}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof a)throw new TypeError;b=b||this,c(b)&&(b=d(b));var e,f,g=b.length,h=[];for(e=0;g>e;e+=1)b.hasOwnProperty(e)&&(f=b[e],a.call(b,f,e,b)&&h.push(f));return h})}(jQuery,window,e),!function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=a(this.options.menu),this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:b.top+b.height,left:b.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var b;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(b=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,b?this.process(b):this)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b,c=[],d=[],e=[];b=a.shift();)b.toLowerCase().indexOf(this.query.toLowerCase())?~b.indexOf(this.query)?d.push(b):e.push(b):c.push(b);return c.concat(d,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(){var b=this.$menu.find(".active").removeClass("active"),c=b.next();c.length||(c=a(this.$menu.find("li")[0])),c.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active"),b=a.prev();b.length||(b=this.$menu.find("li").last()),b.addClass("active")},listen:function(){this.$element.on("focus",a.proxy(this.focus,this)).on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this)).on("mouseleave","li",a.proxy(this.mouseleave,this))},eventSupported:function(a){var b=a in this.$element;return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},focus:function(){this.focused=!0},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(a){a.stopPropagation(),a.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(b){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var c=a.fn.typeahead;a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f="object"==typeof c&&c;e||d.data("typeahead",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},a.fn.typeahead.Constructor=b,a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this},a(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var b=a(this);b.data("typeahead")||b.typeahead(b.data())})}(window.jQuery),function(){function a(a){this._n=a}function b(a,b,c){var d,e=Math.pow(10,b);if(d=(Math.round(a*e)/e).toFixed(b),c){var f=new RegExp("0{1,"+c+"}$");d=d.replace(f,"")}return d}function d(a,b){var c;return c=b.indexOf("$")>-1?f(a,b):b.indexOf("%")>-1?g(a,b):b.indexOf(":")>-1?h(a,b):j(a,b)}function e(a,b){if(b.indexOf(":")>-1)a._n=i(b);else if(b===p)a._n=0;else{var c=b;"."!==n[o].delimiters.decimal&&(b=b.replace(/\./g,"").replace(n[o].delimiters.decimal,"."));for(var d=new RegExp(n[o].abbreviations.thousand+"(?:\\)|(\\"+n[o].currency.symbol+")?(?:\\))?)?$"),e=new RegExp(n[o].abbreviations.million+"(?:\\)|(\\"+n[o].currency.symbol+")?(?:\\))?)?$"),f=new RegExp(n[o].abbreviations.billion+"(?:\\)|(\\"+n[o].currency.symbol+")?(?:\\))?)?$"),g=new RegExp(n[o].abbreviations.trillion+"(?:\\)|(\\"+n[o].currency.symbol+")?(?:\\))?)?$"),h=["KB","MB","GB","TB","PB","EB","ZB","YB"],j=!1,k=0;k<=h.length&&!(j=b.indexOf(h[k])>-1?Math.pow(1024,k+1):!1);k++);a._n=(j?j:1)*(c.match(d)?Math.pow(10,3):1)*(c.match(e)?Math.pow(10,6):1)*(c.match(f)?Math.pow(10,9):1)*(c.match(g)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*Number((b.indexOf("(")>-1?"-":"")+b.replace(/[^0-9\.-]+/g,"")),a._n=j?Math.ceil(a._n):a._n}return a._n}function f(a,b){var c=b.indexOf("$")<=1?!0:!1,e="";b.indexOf(" $")>-1?(e=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(e=" ",b=b.replace("$ ","")):b=b.replace("$","");var f=d(a,b);return c?f.indexOf("(")>-1||f.indexOf("-")>-1?(f=f.split(""),f.splice(1,0,n[o].currency.symbol+e),f=f.join("")):f=n[o].currency.symbol+e+f:f.indexOf(")")>-1?(f=f.split(""),f.splice(-1,0,e+n[o].currency.symbol),f=f.join("")):f=f+e+n[o].currency.symbol,f}function g(a,b){var c="";b.indexOf(" %")>-1?(c=" ",b=b.replace(" %","")):b=b.replace("%",""),a._n=100*a._n;var e=d(a,b);return e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,c+"%"),e=e.join("")):e=e+c+"%",e}function h(a){var b=Math.floor(a._n/60/60),c=Math.floor((a._n-60*60*b)/60),d=Math.round(a._n-60*60*b-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function i(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*60*Number(b[0]),c+=60*Number(b[1]),c+=Number(b[2])):2===b.lenght&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function j(a,c){var d=!1,e=!1,f="",g="",h="",i=Math.abs(a._n);if(0===a._n&&null!==p)return p;if(c.indexOf("(")>-1&&(d=!0,c=c.slice(1,-1)),c.indexOf("a")>-1&&(c.indexOf(" a")>-1?(f=" ",c=c.replace(" a","")):c=c.replace("a",""),i>=Math.pow(10,12)?(f+=n[o].abbreviations.trillion,a._n=a._n/Math.pow(10,12)):i<Math.pow(10,12)&&i>=Math.pow(10,9)?(f+=n[o].abbreviations.billion,a._n=a._n/Math.pow(10,9)):i<Math.pow(10,9)&&i>=Math.pow(10,6)?(f+=n[o].abbreviations.million,a._n=a._n/Math.pow(10,6)):i<Math.pow(10,6)&&i>=Math.pow(10,3)&&(f+=n[o].abbreviations.thousand,a._n=a._n/Math.pow(10,3))),c.indexOf("b")>-1){c.indexOf(" b")>-1?(g=" ",c=c.replace(" b","")):c=c.replace("b","");for(var j,k,l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],m=0;m<=l.length;m++)if(j=Math.pow(1024,m),k=Math.pow(1024,m+1),a._n>=j&&a._n<k){g+=l[m],j>0&&(a._n=a._n/j);break}}c.indexOf("o")>-1&&(c.indexOf(" o")>-1?(h=" ",c=c.replace(" o","")):c=c.replace("o",""),h+=n[o].ordinal(a._n)),c.indexOf("[.]")>-1&&(e=!0,c=c.replace("[.]","."));var q=a._n.toString().split(".")[0],r=c.split(".")[1],s=c.indexOf(","),t="",u=!1;return r?(r.indexOf("[")>-1?(r=r.replace("]",""),r=r.split("["),t=b(a._n,r[0].length+r[1].length,r[1].length)):t=b(a._n,r.length),q=t.split(".")[0],t=t.split(".")[1].length?n[o].delimiters.decimal+t.split(".")[1]:"",e&&0===Number(t)&&(t="")):q=b(a._n,null),q.indexOf("-")>-1&&(q=q.slice(1),u=!0),s>-1&&(q=q.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[o].delimiters.thousands)),0===c.indexOf(".")&&(q=""),(d&&u?"(":"")+(!d&&u?"-":"")+q+t+(h?h:"")+(f?f:"")+(g?g:"")+(d&&u?")":"")}function k(a,b){n[a]=b}var l,m="1.4.7",n={},o="en",p=null,q="undefined"!=typeof c&&c.exports;l=function(b){return l.isNumeral(b)?b=b.value():Number(b)||(b=0),new a(Number(b))},l.version=m,l.isNumeral=function(b){return b instanceof a},l.language=function(a,b){return a?(a&&!b&&(o=a),(b||!n[a])&&k(a,b),l):o},l.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),l.zeroFormat=function(a){p="string"==typeof a?a:null},l.fn=a.prototype={clone:function(){return l(this)},format:function(a){return d(this,a?a:l.defaultFormat)},unformat:function(a){return e(this,a?a:l.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(a){return this._n=Number(a),this},add:function(a){return this._n=this._n+Number(a),this},subtract:function(a){return this._n=this._n-Number(a),this},multiply:function(a){return this._n=this._n*Number(a),this},divide:function(a){return this._n=this._n/Number(a),this},difference:function(a){var b=this._n-Number(a);return 0>b&&(b=-b),b}},q&&(c.exports=l),"undefined"==typeof ender&&(this.numeral=l),"function"==typeof define&&define.amd&&define([],function(){return l})}.call(this),function(a,b){function c(a){for(var b,c=a.split(/\s+/),d=[],e=0;b=c[e];e++)b=b[0].toUpperCase(),d.push(b);return d}function d(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function e(c,f,g){return g||(g=0),f.each(function(){var f,h,i=a(this),j=this,k=this.nodeName.toLowerCase();switch("label"==k&&i.find("input, textarea, select").length&&(f=i.text(),i=i.children().first(),j=i.get(0),k=j.nodeName.toLowerCase()),k){case"menu":h={name:i.attr("label"),items:{}},g=e(h.items,i.children(),g);break;case"a":case"button":h={name:i.text(),disabled:!!i.attr("disabled"),callback:function(){return function(){i.click()}}()};break;case"menuitem":case"command":switch(i.attr("type")){case b:case"command":case"menuitem":h={name:i.attr("label"),disabled:!!i.attr("disabled"),callback:function(){return function(){i.click()
}}()};break;case"checkbox":h={type:"checkbox",disabled:!!i.attr("disabled"),name:i.attr("label"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",disabled:!!i.attr("disabled"),name:i.attr("label"),radio:i.attr("radiogroup"),value:i.attr("id"),selected:!!i.attr("checked")};break;default:h=b}break;case"hr":h="-------";break;case"input":switch(i.attr("type")){case"text":h={type:"text",name:f||d(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"checkbox":h={type:"checkbox",name:f||d(j),disabled:!!i.attr("disabled"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",name:f||d(j),disabled:!!i.attr("disabled"),radio:!!i.attr("name"),value:i.val(),selected:!!i.attr("checked")};break;default:h=b}break;case"select":h={type:"select",name:f||d(j),disabled:!!i.attr("disabled"),selected:i.val(),options:{}},i.children().each(function(){h.options[this.value]=a(this).text()});break;case"textarea":h={type:"textarea",name:f||d(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"label":break;default:h={type:"html",html:i.clone(!0)}}h&&(g++,c["key"+g]=h)}),g}if(a.support.htmlMenuitem="HTMLMenuItemElement"in window,a.support.htmlCommand="HTMLCommandElement"in window,a.support.eventSelectstart="onselectstart"in document.documentElement,!a.ui||!a.ui.widget){var f=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(e){}f(b)}}var g=null,h=!1,i=a(window),j=0,k={},l={},m={},n={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var c=this.offset();c.top+=this.outerHeight(),c.left+=this.outerWidth()/2-b.outerWidth()/2,b.css(c)}},position:function(a,b,c){var d;if(!b&&!c)return a.determinePosition.call(this,a.$menu),void 0;d="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b};var e=i.scrollTop()+i.height(),f=i.scrollLeft()+i.width(),g=a.$menu.height(),h=a.$menu.width();d.top+g>e&&(d.top-=g),d.left+h>f&&(d.left-=h),a.$menu.css(d)},positionSubmenu:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:0,left:this.outerWidth()};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},o={timer:null,pageX:null,pageY:null},p=function(a){for(var b=0,c=a;;)if(b=Math.max(b,parseInt(c.css("z-index"),10)||0),c=c.parent(),!c||!c.length||"html body".indexOf(c.prop("nodeName").toLowerCase())>-1)break;return b},q={abortevent:function(a){a.preventDefault(),a.stopImmediatePropagation()},contextmenu:function(b){var c=a(this);if(b.preventDefault(),b.stopImmediatePropagation(),!("right"!=b.data.trigger&&b.originalEvent||c.hasClass("context-menu-active")||c.hasClass("context-menu-disabled"))){if(g=c,b.data.build){var d=b.data.build(g,b);if(d===!1)return;if(b.data=a.extend(!0,{},n,b.data,d||{}),!b.data.items||a.isEmptyObject(b.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),new Error("No Items sepcified");b.data.$trigger=g,r.create(b.data)}r.show.call(c,b.data,b.pageX,b.pageY)}},click:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(b){var c=a(this);g&&g.length&&!g.is(c)&&g.data("contextMenu").$menu.trigger("contextmenu:hide"),2==b.button&&(g=c.data("contextMenuActive",!0))},mouseup:function(b){var c=a(this);c.data("contextMenuActive")&&g&&g.length&&g.is(c)&&!c.hasClass("context-menu-disabled")&&(b.preventDefault(),b.stopImmediatePropagation(),g=c,c.trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))),c.removeData("contextMenuActive")},mouseenter:function(b){var c=a(this),d=a(b.relatedTarget),e=a(document);d.is(".context-menu-list")||d.closest(".context-menu-list").length||g&&g.length||(o.pageX=b.pageX,o.pageY=b.pageY,o.data=b.data,e.on("mousemove.contextMenuShow",q.mousemove),o.timer=setTimeout(function(){o.timer=null,e.off("mousemove.contextMenuShow"),g=c,c.trigger(a.Event("contextmenu",{data:o.data,pageX:o.pageX,pageY:o.pageY}))},b.data.delay))},mousemove:function(a){o.pageX=a.pageX,o.pageY=a.pageY},mouseleave:function(b){var c=a(b.relatedTarget);if(!c.is(".context-menu-list")&&!c.closest(".context-menu-list").length){try{clearTimeout(o.timer)}catch(b){}o.timer=null}},layerClick:function(b){var c,d,e=a(this),f=e.data("contextMenuRoot"),g=b.button,h=b.pageX,j=b.pageY;b.preventDefault(),b.stopImmediatePropagation(),setTimeout(function(){var e,k="left"==f.trigger&&0===g||"right"==f.trigger&&2===g;if(document.elementFromPoint&&(f.$layer.hide(),c=document.elementFromPoint(h-i.scrollLeft(),j-i.scrollTop()),f.$layer.show()),f.reposition&&k)if(document.elementFromPoint){if(f.$trigger.is(c)||f.$trigger.has(c).length)return f.position.call(f.$trigger,f,h,j),void 0}else if(d=f.$trigger.offset(),e=a(window),d.top+=e.scrollTop(),d.top<=b.pageY&&(d.left+=e.scrollLeft(),d.left<=b.pageX&&(d.bottom=d.top+f.$trigger.outerHeight(),d.bottom>=b.pageY&&(d.right=d.left+f.$trigger.outerWidth(),d.right>=b.pageX))))return f.position.call(f.$trigger,f,h,j),void 0;c&&k&&f.$trigger.one("contextmenu:hidden",function(){a(c).contextMenu({x:h,y:j})}),f.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault(),a.stopPropagation()},key:function(a){var b=g.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(q.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),b.$menu.trigger("prevcommand"),void 0;if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return a.preventDefault(),void 0}else if(9!=a.keyCode||a.shiftKey)return b.$menu.trigger("prevcommand"),void 0;case 40:if(q.keyStop(a,b),!b.isInput)return b.$menu.trigger("nextcommand"),void 0;if(9==a.keyCode)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),b.$menu.trigger("nextcommand"),void 0;if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return a.preventDefault(),void 0;break;case 37:if(q.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){var c=b.$selected.parent().parent();return b.$selected.trigger("contextmenu:blur"),b.$selected=c,void 0}break;case 39:if(q.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;var d=b.$selected.data("contextMenu")||{};if(d.$menu&&b.$selected.hasClass("context-menu-submenu"))return b.$selected=null,d.$selected=null,d.$menu.trigger("nextcommand"),void 0;break;case 35:case 36:return b.$selected&&b.$selected.find("input, textarea, select").length?void 0:((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault(),void 0);case 13:if(q.keyStop(a,b),b.isInput){if(b.$selected&&!b.$selected.is("textarea, select"))return a.preventDefault(),void 0;break}return b.$selected&&b.$selected.trigger("mouseup"),void 0;case 32:case 33:case 34:return q.keyStop(a,b),void 0;case 27:return q.keyStop(a,b),b.$menu.trigger("contextmenu:hide"),void 0;default:var e=String.fromCharCode(a.keyCode).toUpperCase();if(b.accesskeys[e])return b.accesskeys[e].$node.trigger(b.accesskeys[e].$menu?"contextmenu:focus":"mouseup"),void 0}a.stopPropagation(),b.$selected&&b.$selected.trigger(a)},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=d}for(var e=c.$menu.children(),f=c.$selected&&c.$selected.prev().length?c.$selected.prev():e.last(),g=f;f.hasClass("disabled")||f.hasClass("not-selectable");)if(f=f.prev().length?f.prev():e.last(),f.is(g))return;c.$selected&&q.itemMouseleave.call(c.$selected.get(0),b),q.itemMouseenter.call(f.get(0),b);var h=f.find("input, textarea, select");h.length&&h.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=d}for(var e=c.$menu.children(),f=c.$selected&&c.$selected.next().length?c.$selected.next():e.first(),g=f;f.hasClass("disabled")||f.hasClass("not-selectable");)if(f=f.next().length?f.next():e.first(),f.is(g))return;c.$selected&&q.itemMouseleave.call(c.$selected.get(0),b),q.itemMouseenter.call(f.get(0),b);var h=f.find("input, textarea, select");h.length&&h.focus()},focusInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,e=c.contextMenuRoot;e.$selected=d.$selected=b,e.isInput=d.isInput=!0},blurInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,e=c.contextMenuRoot;e.isInput=d.isInput=!1},menuMouseenter:function(){var b=a(this).data().contextMenuRoot;b.hovering=!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;c.$layer&&c.$layer.is(b.relatedTarget)&&(c.hovering=!1)},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f.hovering=!0,b&&f.$layer&&f.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation()),(e.$menu?e:f).$menu.children(".hover").trigger("contextmenu:blur"),c.hasClass("disabled")||c.hasClass("not-selectable")?(e.$selected=null,void 0):(c.trigger("contextmenu:focus"),void 0)},itemMouseleave:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f!==e&&f.$layer&&f.$layer.is(b.relatedTarget)?(f.$selected&&f.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),f.$selected=e.$selected=e.$node,void 0):(c.trigger("contextmenu:blur"),void 0)},itemClick:function(b){var c,d=a(this),e=d.data(),f=e.contextMenu,g=e.contextMenuRoot,h=e.contextMenuKey;if(f.items[h]&&!d.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(b.preventDefault(),b.stopImmediatePropagation(),a.isFunction(g.callbacks[h])&&Object.prototype.hasOwnProperty.call(g.callbacks,h))c=g.callbacks[h];else{if(!a.isFunction(g.callback))return;c=g.callback}c.call(g.$trigger,h,g)!==!1?g.$menu.trigger("contextmenu:hide"):g.$menu.parent().length&&r.update.call(g.$trigger,g)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");r.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;c.addClass("hover").siblings(".hover").trigger("contextmenu:blur"),e.$selected=f.$selected=c,e.$node&&f.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu;d.contextMenuRoot,c.removeClass("hover"),e.$selected=null}},r={show:function(b,c,d){var e=a(this),f={};return a("#context-menu-layer").trigger("mousedown"),b.$trigger=e,b.events.show.call(e,b)===!1?(g=null,void 0):(r.update.call(e,b),b.position.call(e,b,c,d),b.zIndex&&(f.zIndex=p(e)+b.zIndex),r.layer.call(b.$menu,b,f.zIndex),b.$menu.find("ul").css("zIndex",f.zIndex+1),b.$menu.css(f)[b.animation.show](b.animation.duration,function(){e.trigger("contextmenu:visible")}),e.data("contextMenu",b).addClass("context-menu-active"),a(document).off("keydown.contextMenu").on("keydown.contextMenu",q.key),b.autoHide&&a(document).on("mousemove.contextMenuAutoHide",function(a){var c=e.offset();c.right=c.left+e.outerWidth(),c.bottom=c.top+e.outerHeight(),!b.$layer||b.hovering||a.pageX>=c.left&&a.pageX<=c.right&&a.pageY>=c.top&&a.pageY<=c.bottom||b.$menu.trigger("contextmenu:hide")}),void 0)},hide:function(c,d){var e=a(this);if(c||(c=e.data("contextMenu")||{}),d||!c.events||c.events.hide.call(e,c)!==!1){if(e.removeData("contextMenu").removeClass("context-menu-active"),c.$layer){setTimeout(function(a){return function(){a.remove()}}(c.$layer),10);try{delete c.$layer}catch(f){c.$layer=null}}g=null,c.$menu.find(".hover").trigger("contextmenu:blur"),c.$selected=null,a(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a){switch(a){case"ns":case"selector":case"build":case"trigger":return!0;default:c[a]=b;try{delete c[a]}catch(d){}return!0}})),setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(d,e){e===b&&(e=d),d.$menu=a('<ul class="context-menu-list"></ul>').addClass(d.className||"").data({contextMenu:d,contextMenuRoot:e}),a.each(["callbacks","commands","inputs"],function(a,b){d[b]={},e[b]||(e[b]={})}),e.accesskeys||(e.accesskeys={}),a.each(d.items,function(b,f){var g=a('<li class="context-menu-item"></li>').addClass(f.className||""),h=null,i=null;if(g.on("click",a.noop),f.$node=g.data({contextMenu:d,contextMenuRoot:e,contextMenuKey:b}),f.accesskey)for(var j,k=c(f.accesskey),l=0;j=k[l];l++)if(!e.accesskeys[j]){e.accesskeys[j]=f,f._name=f.name.replace(new RegExp("("+j+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof f)g.addClass("context-menu-separator not-selectable");else if(f.type&&m[f.type])m[f.type].call(g,f,d,e),a.each([d,e],function(c,d){d.commands[b]=f,a.isFunction(f.callback)&&(d.callbacks[b]=f.callback)});else{switch("html"==f.type?g.addClass("context-menu-html not-selectable"):f.type?(h=a("<label></label>").appendTo(g),a("<span></span>").html(f._name||f.name).appendTo(h),g.addClass("context-menu-input"),d.hasTypes=!0,a.each([d,e],function(a,c){c.commands[b]=f,c.inputs[b]=f})):f.items&&(f.type="sub"),f.type){case"text":i=a('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(f.value||"").appendTo(h);break;case"textarea":i=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+b).val(f.value||"").appendTo(h),f.height&&i.height(f.height);break;case"checkbox":i=a('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"radio":i=a('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"select":i=a('<select name="">').attr("name","context-menu-input-"+b).appendTo(h),f.options&&(a.each(f.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(i)}),i.val(f.selected));break;case"sub":a("<span></span>").html(f._name||f.name).appendTo(g),f.appendTo=f.$node,r.create(f,e),g.data("contextMenu",f).addClass("context-menu-submenu"),f.callback=null;break;case"html":a(f.html).appendTo(g);break;default:a.each([d,e],function(c,d){d.commands[b]=f,a.isFunction(f.callback)&&(d.callbacks[b]=f.callback)}),a("<span></span>").html(f._name||f.name||"").appendTo(g)}f.type&&"sub"!=f.type&&"html"!=f.type&&(i.on("focus",q.focusInput).on("blur",q.blurInput),f.events&&i.on(f.events,d)),f.icon&&g.addClass("icon icon-"+f.icon)}f.$input=i,f.$label=h,g.appendTo(d.$menu),!d.hasTypes&&a.support.eventSelectstart&&g.on("selectstart.disableTextSelect",q.abortevent)}),d.$node||d.$menu.css("display","none").addClass("context-menu-root"),d.$menu.appendTo(d.appendTo||document.body)},resize:function(b,c){b.css({position:"absolute",display:"block"}),b.data("width",Math.ceil(b.width())+1),b.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),b.find("> li > ul").each(function(){r.resize(a(this),!0)}),c||b.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return a(this).data("width")})},update:function(c,d){var e=this;d===b&&(d=c,r.resize(c.$menu)),c.$menu.children().each(function(){var b=a(this),f=b.data("contextMenuKey"),g=c.items[f],h=a.isFunction(g.disabled)&&g.disabled.call(e,f,d)||g.disabled===!0;if(b[h?"addClass":"removeClass"]("disabled"),g.type)switch(b.find("input, select, textarea").prop("disabled",h),g.type){case"text":case"textarea":g.$input.val(g.value||"");break;case"checkbox":case"radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case"select":g.$input.val(g.selected||"")}g.$menu&&r.update.call(e,g,d)})},layer:function(b,c){var d=b.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+c+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:i.height(),width:i.width(),display:"block"}).data("contextMenuRoot",b).insertBefore(this).on("contextmenu",q.abortevent).on("mousedown",q.layerClick);return a.support.fixedPosition||d.css({position:"absolute",height:a(document).height()}),d}};a.fn.contextMenu=function(c){if(c===b)this.first().trigger("contextmenu");else if(c.x&&c.y)this.first().trigger(a.Event("contextmenu",{pageX:c.x,pageY:c.y}));else if("hide"===c){var d=this.data("contextMenu").$menu;d&&d.trigger("contextmenu:hide")}else"destroy"===c?a.contextMenu("destroy",{context:this}):a.isPlainObject(c)?(c.context=this,a.contextMenu("create",c)):c?this.removeClass("context-menu-disabled"):c||this.addClass("context-menu-disabled");return this},a.contextMenu=function(c,d){"string"!=typeof c&&(d=c,c="create"),"string"==typeof d?d={selector:d}:d===b&&(d={});var e=a.extend(!0,{},n,d||{}),f=a(document),g=f,i=!1;switch(e.context&&e.context.length?(g=a(e.context).first(),e.context=g.get(0),i=e.context!==document):e.context=document,c){case"create":if(!e.selector)throw new Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||a.isEmptyObject(e.items)))throw new Error("No Items sepcified");switch(j++,e.ns=".contextMenu"+j,i||(k[e.selector]=e.ns),l[e.ns]=e,e.trigger||(e.trigger="right"),h||(f.on({"contextmenu:hide.contextMenu":q.hideMenu,"prevcommand.contextMenu":q.prevItem,"nextcommand.contextMenu":q.nextItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.menuMouseenter,"mouseleave.contextMenu":q.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",q.inputClick).on({"mouseup.contextMenu":q.itemClick,"contextmenu:focus.contextMenu":q.focusItem,"contextmenu:blur.contextMenu":q.blurItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.itemMouseenter,"mouseleave.contextMenu":q.itemMouseleave},".context-menu-item"),h=!0),g.on("contextmenu"+e.ns,e.selector,e,q.contextmenu),i&&g.on("remove"+e.ns,function(){a(this).contextMenu("destroy")}),e.trigger){case"hover":g.on("mouseenter"+e.ns,e.selector,e,q.mouseenter).on("mouseleave"+e.ns,e.selector,e,q.mouseleave);break;case"left":g.on("click"+e.ns,e.selector,e,q.click)}e.build||r.create(e);break;case"destroy":var m;if(i){var o=e.context;a.each(l,function(b,c){if(c.context!==o)return!0;m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&m.trigger("contextmenu:hide",{force:!0});try{l[c.ns].$menu&&l[c.ns].$menu.remove(),delete l[c.ns]}catch(d){l[c.ns]=null}return a(c.context).off(c.ns),!0})}else if(e.selector){if(k[e.selector]){m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(e.selector)&&m.trigger("contextmenu:hide",{force:!0});try{l[k[e.selector]].$menu&&l[k[e.selector]].$menu.remove(),delete l[k[e.selector]]}catch(p){l[k[e.selector]]=null}f.off(k[e.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),a.each(l,function(b,c){a(c.context).off(c.ns)}),k={},l={},j=0,h=!1,a("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||"boolean"==typeof d&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+c+'"')}return this},a.contextMenu.setInputValues=function(c,d){d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":b.value=d[a]||"";break;case"checkbox":b.selected=d[a]?!0:!1;break;case"radio":b.selected=(d[b.radio]||"")==b.value?!0:!1;break;case"select":b.selected=d[a]||""}})},a.contextMenu.getInputValues=function(c,d){return d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":case"select":d[a]=b.$input.val();break;case"checkbox":d[a]=b.$input.prop("checked");break;case"radio":b.$input.prop("checked")&&(d[b.radio]=b.value)}}),d},a.contextMenu.fromMenu=function(b){var c=a(b),d={};return e(d,c.children()),d},a.contextMenu.defaults=n,a.contextMenu.types=m,a.contextMenu.handle=q,a.contextMenu.op=r,a.contextMenu.menus=l}(jQuery),this.jQuery=d});
