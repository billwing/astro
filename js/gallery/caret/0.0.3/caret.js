define("gallery/caret/0.0.3/caret",["$"],function(a){var b=a("$");(function(){!function(a){return"function"==typeof define&&define.amd?define(["gallery"],a):a(b)}(function(a){"use strict";var b,c,d,e,f,g;return g="caret",b=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.setPos=function(){return this.domInputor},b.prototype.getIEPosition=function(){return a.noop()},b.prototype.getPosition=function(){return a.noop()},b.prototype.getOldIEPos=function(){var a,b;return b=document.selection.createRange(),a=document.body.createTextRange(),a.moveToElementText(this.domInputor),a.setEndPoint("EndToEnd",b),a.text.length},b.prototype.getPos=function(){var a,b,c;return(c=this.range())?(a=c.cloneRange(),a.selectNodeContents(this.domInputor),a.setEnd(c.endContainer,c.endOffset),b=a.toString().length,a.detach(),b):document.selection?this.getOldIEPos():void 0},b.prototype.getOldIEOffset=function(){var a,b;return a=document.selection.createRange().duplicate(),a.moveStart("character",-1),b=a.getBoundingClientRect(),{height:b.bottom-b.top,left:b.left,top:b.top}},b.prototype.getOffset=function(){var a,b,c,d;if(b=null,window.getSelection&&(c=this.range())){if(c.endOffset-1<0)return null;a=c.cloneRange(),a.setStart(c.endContainer,c.endOffset-1),a.setEnd(c.endContainer,c.endOffset),d=a.getBoundingClientRect(),b={height:d.height,left:d.left+d.width,top:d.top},a.detach()}else document.selection&&this.getOldIEOffset();return e.adjustOffset(b,this.$inputor)},b.prototype.range=function(){var a;if(window.getSelection)return a=window.getSelection(),a.rangeCount>0?a.getRangeAt(0):null},b}(),c=function(){function a(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return a.prototype.getIEPos=function(){var a,b,c,d,e,f,g;return b=this.domInputor,f=document.selection.createRange(),e=0,f&&f.parentElement()===b&&(d=b.value.replace(/\r\n/g,"\n"),c=d.length,g=b.createTextRange(),g.moveToBookmark(f.getBookmark()),a=b.createTextRange(),a.collapse(!1),e=g.compareEndPoints("StartToEnd",a)>-1?c:-g.moveStart("character",-c)),e},a.prototype.getPos=function(){return document.selection?this.getIEPos():this.domInputor.selectionStart},a.prototype.setPos=function(a){var b,c;return b=this.domInputor,document.selection?(c=b.createTextRange(),c.move("character",a),c.select()):b.setSelectionRange&&b.setSelectionRange(a,a),b},a.prototype.getIEOffset=function(a){var b,c,d,e,f;return d=this.domInputor.createTextRange(),a?d.move("character",a):(c=document.selection.createRange(),d.moveToBookmark(c.getBookmark())),e=d.boundingLeft,f=d.boundingTop,b=d.boundingHeight,{left:e,top:f,height:b}},a.prototype.getOffset=function(a){var b,c,d;return b=this.$inputor,document.selection?e.adjustOffset(this.getIEOffset(a),b):(c=b.offset(),d=this.getPosition(a),c={left:c.left+d.left,top:c.top+d.top,height:d.height})},a.prototype.getPosition=function(a){var b,c,e,f,g,h;return b=this.$inputor,e=function(a){return a.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},void 0===a&&(a=this.getPos()),h=b.val().slice(0,a),f="<span>"+e(h)+"</span>",f+="<span id='caret'>|</span>",g=new d(b),c=g.create(f).rect()},a.prototype.getIEPosition=function(a){var b,c,d,e,f;return d=this.getIEOffset(a),c=this.$inputor.offset(),e=d.left-c.left,f=d.top-c.top,b=d.height,{left:e,top:f,height:b}},a}(),d=function(){function b(a){this.$inputor=a}return b.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],b.prototype.mirrorCss=function(){var b,c=this;return b={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},a.each(this.css_attr,function(a,d){return b[d]=c.$inputor.css(d)}),b},b.prototype.create=function(b){return this.$mirror=a("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(b),this.$inputor.after(this.$mirror),this},b.prototype.rect=function(){var a,b,c;return a=this.$mirror.find("#caret"),b=a.position(),c={left:b.left,top:b.top,height:a.height()},this.$mirror.remove(),c},b}(),e={adjustOffset:function(b,c){return b?(b.top+=a(window).scrollTop()+c.scrollTop(),b.left+=+a(window).scrollLeft()+c.scrollLeft(),b):void 0},contentEditable:function(a){return!(!a[0].contentEditable||"true"!==a[0].contentEditable)}},f={pos:function(a){return a?this.setPos(a):this.getPos()},position:function(a){return document.selection?this.getIEPosition(a):this.getPosition(a)},offset:function(a){return this.getOffset(a)}},a.fn.caret=function(d){var g;return g=e.contentEditable(this)?new b(this):new c(this),f[d]?f[d].apply(g,Array.prototype.slice.call(arguments,1)):a.error("Method "+d+" does not exist on jQuery.caret")},a.fn.caret.EditableCaret=b,a.fn.caret.InputCaret=c,a.fn.caret.Utils=e,a.fn.caret.apis=f})}).call(this)});
